# æ¡£æ¡ˆç®¡ç†ç³»ç»Ÿ - é¡¹ç›®å®Œå–„è®¡åˆ’ä¸è¡ŒåŠ¨æŒ‡å—

> **ç”Ÿæˆæ—¶é—´**: 2025å¹´10æœˆ10æ—¥  
> **é¡¹ç›®çŠ¶æ€**: æ ¸å¿ƒåŠŸèƒ½å·²å®Œæˆï¼Œéœ€è¦ä¼˜åŒ–æå‡  
> **å®Œæˆåº¦è¯„ä¼°**: 85%  
> **å»ºè®®æ‰§è¡Œå‘¨æœŸ**: 3-6ä¸ªæœˆ

---

## ğŸ“Š é¡¹ç›®ç°çŠ¶å…¨é¢è¯„ä¼°

### âœ… å·²å®Œæˆçš„æ ¸å¿ƒåŠŸèƒ½

#### 1. åç«¯æ¶æ„ (å®Œæˆåº¦: 90%)
- **æŠ€æœ¯æ ˆ**: Spring Boot 3.2.x + Spring Security 6.x + MyBatis Plus
- **æ§åˆ¶å™¨å±‚**: 21ä¸ªControllerï¼Œè¦†ç›–æ‰€æœ‰æ ¸å¿ƒä¸šåŠ¡
- **æœåŠ¡å±‚**: 35ä¸ªServiceå®ç°ï¼Œä¸šåŠ¡é€»è¾‘å®Œæ•´
- **Javaæ–‡ä»¶**: 324ä¸ªæºæ–‡ä»¶ï¼Œä»£ç é‡å……è¶³

**æ ¸å¿ƒæ¨¡å—æ¸…å•**:
- âœ… ç”¨æˆ·è®¤è¯ä¸æˆæƒ (AuthController, AuthService)
- âœ… æ¡£æ¡ˆç®¡ç† (ArchiveController, ArchiveService)
- âœ… å€Ÿé˜…ç®¡ç† (BorrowController, BorrowService)
- âœ… æƒé™ç®¡ç† (PermissionController, RoleController)
- âœ… ç³»ç»Ÿé…ç½® (SystemController, SystemConfigController)
- âœ… ç»Ÿè®¡åˆ†æ (StatisticsController, StatisticsService)
- âœ… å®¡è®¡æ—¥å¿— (AuditLogController, AuditLogService)
- âœ… é€šçŸ¥æœåŠ¡ (NotificationController, NotificationService)
- âœ… å·¥ä½œæµå¼•æ“ (WorkflowController, WorkflowService)
- âœ… é«˜çº§æœç´¢ (AdvancedSearchController, AdvancedSearchService)
- âœ… æ‰¹é‡æ“ä½œ (BatchOperationController)
- âœ… æ–‡ä»¶ç®¡ç† (ArchiveFileController, FileStorageService)
- âœ… å¯¼å‡ºåŠŸèƒ½ (ExportController, MultiFormatExportService)
- âœ… æ€§èƒ½ç›‘æ§ (PerformanceMonitoringController)
- âœ… åˆ†ç±»ç®¡ç† (CategoryController, CategoryService)

#### 2. å‰ç«¯æ¶æ„ (å®Œæˆåº¦: 85%)
- **æŠ€æœ¯æ ˆ**: Vue 3 + TypeScript + Element Plus + Vite
- **é¡µé¢æ•°é‡**: 30+ä¸ªé¡µé¢ç»„ä»¶
- **è·¯ç”±é…ç½®**: å®Œæ•´çš„è·¯ç”±å®ˆå«å’Œæƒé™æ§åˆ¶

**å·²å®ç°é¡µé¢**:
- âœ… è®¤è¯æ¨¡å—: ç™»å½•ã€æ³¨å†Œ
- âœ… ä»ªè¡¨æ¿: æ•°æ®æ¦‚è§ˆ
- âœ… æ¡£æ¡ˆç®¡ç†: åˆ—è¡¨ã€è¯¦æƒ…ã€æ–°å¢/ç¼–è¾‘ã€åˆ†ç±»ã€é«˜çº§æœç´¢
- âœ… å€Ÿé˜…ç®¡ç†: å€Ÿé˜…è®°å½•ã€ç”³è¯·ã€å½’è¿˜ã€é€¾æœŸç®¡ç†
- âœ… ç”¨æˆ·ç®¡ç†: ç”¨æˆ·åˆ—è¡¨
- âœ… ç»Ÿè®¡åˆ†æ: æ•°æ®æ¦‚è§ˆã€æ¡£æ¡ˆç»Ÿè®¡ã€å€Ÿé˜…ç»Ÿè®¡ã€ç”¨æˆ·ç»Ÿè®¡ã€æŠ¥è¡¨ç®¡ç†ã€ç”¨æˆ·è¡Œä¸ºåˆ†æã€ç³»ç»Ÿç›‘æ§
- âœ… é€šçŸ¥ä¸­å¿ƒ: æ¶ˆæ¯é€šçŸ¥
- âœ… ç³»ç»Ÿç®¡ç†: ç”¨æˆ·ç®¡ç†ã€è§’è‰²ç®¡ç†ã€æƒé™ç®¡ç†ã€æ“ä½œæ—¥å¿—ã€ç³»ç»Ÿè®¾ç½®ã€ä¸ªæ€§åŒ–è®¾ç½®
- âœ… é”™è¯¯é¡µé¢: 403ã€404

#### 3. æ•°æ®åº“è®¾è®¡ (å®Œæˆåº¦: 95%)
- **æ•°æ®åº“**: MySQL 8.0+
- **è¡¨ç»“æ„**: å®Œæ•´çš„æ•°æ®åº“è®¾è®¡æ–‡æ¡£
- **SQLè„šæœ¬**: å¤šä¸ªåˆå§‹åŒ–å’Œä¼˜åŒ–è„šæœ¬
  - 01_database_init.sql - æ•°æ®åº“åˆå§‹åŒ–
  - 02_constraints.sql - çº¦æŸå®šä¹‰
  - 03_triggers.sql - è§¦å‘å™¨
  - 04_init_data.sql - åˆå§‹æ•°æ®
  - 05_maintenance.sql - ç»´æŠ¤è„šæœ¬
  - 06_additional_tables.sql - æ‰©å±•è¡¨
  - 07_wechat_login.sql - å¾®ä¿¡ç™»å½•
  - 08_backup_table.sql - å¤‡ä»½è¡¨
  - 09_notification_template_table.sql - é€šçŸ¥æ¨¡æ¿
  - 10_export_task.sql - å¯¼å‡ºä»»åŠ¡

#### 4. åŸºç¡€è®¾æ–½ (å®Œæˆåº¦: 80%)
- âœ… Dockerå®¹å™¨åŒ–éƒ¨ç½²
- âœ… Docker Composeç¼–æ’
- âœ… Nginxåå‘ä»£ç†é…ç½®
- âœ… æ€§èƒ½ç›‘æ§ (Prometheus + Grafana)
- âœ… æ—¥å¿—ç®¡ç†
- âœ… å¤‡ä»½æœºåˆ¶

---

## ğŸ¯ éœ€è¦å®Œå–„çš„åŠŸèƒ½æ¨¡å—

### é«˜ä¼˜å…ˆçº§ (1-2ä¸ªæœˆå®Œæˆ)

#### 1. å®æ—¶é€šçŸ¥ç³»ç»Ÿå¢å¼º â­â­â­â­â­
**å½“å‰çŠ¶æ€**: åŸºç¡€é€šçŸ¥åŠŸèƒ½å·²å®ç°ï¼Œä½†ç¼ºå°‘å®æ—¶æ¨é€  
**ä¸šåŠ¡ä»·å€¼**: æå‡ç”¨æˆ·ä½“éªŒå’Œå·¥ä½œæ•ˆç‡  
**æŠ€æœ¯éš¾åº¦**: â­â­â­

**éœ€è¦å®ç°çš„åŠŸèƒ½**:
- [ ] WebSocketå®æ—¶æ¶ˆæ¯æ¨é€
- [ ] æ¶ˆæ¯ä¸­å¿ƒUIç•Œé¢ä¼˜åŒ–
- [ ] æœªè¯»æ¶ˆæ¯æ•°é‡æç¤º
- [ ] æ¶ˆæ¯åˆ†ç±»å’Œç­›é€‰
- [ ] æ¶ˆæ¯æ‰¹é‡æ“ä½œ (æ ‡è®°å·²è¯»ã€åˆ é™¤)
- [ ] é‚®ä»¶é€šçŸ¥æ¨¡æ¿ç³»ç»Ÿ
- [ ] çŸ­ä¿¡é€šçŸ¥é›†æˆ (å¯é€‰)
- [ ] æ¶ˆæ¯æ¨é€ç­–ç•¥é…ç½®

**æŠ€æœ¯å®ç°æ–¹æ¡ˆ**:
```java
// WebSocketé…ç½®
@Configuration
@EnableWebSocket
public class WebSocketConfig implements WebSocketConfigurer {
    @Override
    public void registerWebSocketHandlers(WebSocketHandlerRegistry registry) {
        registry.addHandler(notificationHandler(), "/ws/notifications")
                .setAllowedOrigins("*")
                .withSockJS();
    }
}

// æ¶ˆæ¯æ¨é€æœåŠ¡
@Service
public class RealtimeNotificationService {
    private final SimpMessagingTemplate messagingTemplate;
    
    public void pushToUser(Long userId, Notification notification) {
        messagingTemplate.convertAndSendToUser(
            userId.toString(), 
            "/queue/notifications", 
            notification
        );
    }
}
```

**å‰ç«¯å®ç°**:
```typescript
// WebSocketè¿æ¥ç®¡ç†
export class NotificationWebSocket {
  private socket: WebSocket | null = null;
  
  connect(userId: string) {
    this.socket = new WebSocket(`ws://localhost:8080/ws/notifications`);
    this.socket.onmessage = (event) => {
      const notification = JSON.parse(event.data);
      this.handleNotification(notification);
    };
  }
  
  private handleNotification(notification: any) {
    // æ˜¾ç¤ºé€šçŸ¥æç¤º
    ElNotification({
      title: notification.title,
      message: notification.content,
      type: notification.type
    });
    
    // æ›´æ–°æœªè¯»æ¶ˆæ¯æ•°
    notificationStore.incrementUnread();
  }
}
```

**é¢„æœŸæˆæœ**:
- å®æ—¶æ¶ˆæ¯æ¨é€å»¶è¿Ÿ < 500ms
- æ”¯æŒ1000+å¹¶å‘WebSocketè¿æ¥
- æ¶ˆæ¯é€è¾¾ç‡ > 99%

#### 2. ç§»åŠ¨ç«¯å“åº”å¼é€‚é… â­â­â­â­â­
**å½“å‰çŠ¶æ€**: ä¸»è¦é¢å‘æ¡Œé¢ç«¯è®¾è®¡  
**ä¸šåŠ¡ä»·å€¼**: æ»¡è¶³ç§»åŠ¨åŠå…¬éœ€æ±‚ï¼Œæ‰©å¤§ç”¨æˆ·ç¾¤ä½“  
**æŠ€æœ¯éš¾åº¦**: â­â­â­

**éœ€è¦å®ç°çš„åŠŸèƒ½**:
- [ ] å“åº”å¼å¸ƒå±€ä¼˜åŒ– (é€‚é…æ‰‹æœºã€å¹³æ¿)
- [ ] ç§»åŠ¨ç«¯å¯¼èˆªèœå•ä¼˜åŒ–
- [ ] è§¦æ‘¸æ‰‹åŠ¿æ”¯æŒ
- [ ] ç§»åŠ¨ç«¯è¡¨å•ä¼˜åŒ–
- [ ] ç§»åŠ¨ç«¯è¡¨æ ¼ä¼˜åŒ– (æ»‘åŠ¨ã€æŠ˜å )
- [ ] å›¾ç‰‡/æ–‡ä»¶ä¸Šä¼ ä¼˜åŒ–
- [ ] ç¦»çº¿æ•°æ®ç¼“å­˜ (å¯é€‰)
- [ ] PWAæ”¯æŒ (å¯é€‰)

**æŠ€æœ¯å®ç°æ–¹æ¡ˆ**:
```vue
<!-- å“åº”å¼å¸ƒå±€ç¤ºä¾‹ -->
<template>
  <div class="responsive-container">
    <!-- æ¡Œé¢ç«¯æ˜¾ç¤º -->
    <el-table v-if="!isMobile" :data="tableData">
      <!-- å®Œæ•´è¡¨æ ¼åˆ— -->
    </el-table>
    
    <!-- ç§»åŠ¨ç«¯æ˜¾ç¤º -->
    <div v-else class="mobile-list">
      <el-card v-for="item in tableData" :key="item.id" class="mobile-card">
        <!-- å¡ç‰‡å¼æ˜¾ç¤º -->
      </el-card>
    </div>
  </div>
</template>

<script setup lang="ts">
import { ref, onMounted, onUnmounted } from 'vue';

const isMobile = ref(false);

const checkDevice = () => {
  isMobile.value = window.innerWidth < 768;
};

onMounted(() => {
  checkDevice();
  window.addEventListener('resize', checkDevice);
});

onUnmounted(() => {
  window.removeEventListener('resize', checkDevice);
});
</script>

<style scoped>
.mobile-card {
  margin-bottom: 10px;
}

@media (max-width: 768px) {
  .responsive-container {
    padding: 10px;
  }
}
</style>
```

**CSSåª’ä½“æŸ¥è¯¢ç­–ç•¥**:
```scss
// å“åº”å¼æ–­ç‚¹
$breakpoints: (
  'mobile': 576px,
  'tablet': 768px,
  'desktop': 1024px,
  'wide': 1440px
);

// ç§»åŠ¨ç«¯ä¼˜åŒ–
@media (max-width: 768px) {
  .sidebar {
    position: fixed;
    transform: translateX(-100%);
    transition: transform 0.3s;
    
    &.open {
      transform: translateX(0);
    }
  }
  
  .main-content {
    margin-left: 0;
  }
  
  .table-container {
    overflow-x: auto;
  }
}
```

**é¢„æœŸæˆæœ**:
- æ”¯æŒå±å¹•å°ºå¯¸: 320px - 1920px
- ç§»åŠ¨ç«¯é¡µé¢åŠ è½½æ—¶é—´ < 3ç§’
- è§¦æ‘¸æ“ä½œæµç•…åº¦ > 90%

#### 3. é«˜çº§æŠ¥è¡¨ç³»ç»Ÿ â­â­â­â­
**å½“å‰çŠ¶æ€**: åŸºç¡€ç»Ÿè®¡åŠŸèƒ½å­˜åœ¨  
**ä¸šåŠ¡ä»·å€¼**: æ”¯æŒæ•°æ®é©±åŠ¨å†³ç­–  
**æŠ€æœ¯éš¾åº¦**: â­â­â­â­

**éœ€è¦å®ç°çš„åŠŸèƒ½**:
- [ ] å¯è§†åŒ–æŠ¥è¡¨æ„å»ºå™¨
- [ ] è‡ªå®šä¹‰æŠ¥è¡¨æ¨¡æ¿
- [ ] å¤šç»´åº¦æ•°æ®åˆ†æ
- [ ] æ•°æ®å¯¼å‡º (Excel, PDF, CSV)
- [ ] å®šæ—¶æŠ¥è¡¨ç”Ÿæˆ
- [ ] æŠ¥è¡¨è®¢é˜…å’Œæ¨é€
- [ ] æŠ¥è¡¨æƒé™æ§åˆ¶
- [ ] äº¤äº’å¼å›¾è¡¨ (ECharts)

**æŠ€æœ¯å®ç°æ–¹æ¡ˆ**:
```java
// æŠ¥è¡¨ç”ŸæˆæœåŠ¡
@Service
public class ReportGenerationService {
    
    public ReportResult generateReport(ReportConfig config) {
        // 1. æ„å»ºæŸ¥è¯¢SQL
        String sql = buildQuerySQL(config);
        
        // 2. æ‰§è¡ŒæŸ¥è¯¢
        List<Map<String, Object>> data = jdbcTemplate.queryForList(sql);
        
        // 3. æ•°æ®å¤„ç†å’Œèšåˆ
        ReportData processed = processData(data, config);
        
        // 4. ç”Ÿæˆå›¾è¡¨é…ç½®
        ChartConfig chartConfig = generateChartConfig(processed, config);
        
        // 5. ä¿å­˜æŠ¥è¡¨
        return saveReport(processed, chartConfig, config);
    }
    
    public byte[] exportToExcel(Long reportId) {
        ReportData data = getReportData(reportId);
        return excelExporter.export(data);
    }
    
    public byte[] exportToPDF(Long reportId) {
        ReportData data = getReportData(reportId);
        return pdfExporter.export(data);
    }
}
```

**å‰ç«¯æŠ¥è¡¨é…ç½®å™¨**:
```vue
<template>
  <div class="report-builder">
    <!-- æ•°æ®æºé€‰æ‹© -->
    <el-form-item label="æ•°æ®æº">
      <el-select v-model="config.dataSource">
        <el-option label="æ¡£æ¡ˆæ•°æ®" value="archive" />
        <el-option label="å€Ÿé˜…æ•°æ®" value="borrow" />
        <el-option label="ç”¨æˆ·æ•°æ®" value="user" />
      </el-select>
    </el-form-item>
    
    <!-- ç»´åº¦é€‰æ‹© -->
    <el-form-item label="åˆ†æç»´åº¦">
      <el-checkbox-group v-model="config.dimensions">
        <el-checkbox label="æ—¶é—´" />
        <el-checkbox label="åˆ†ç±»" />
        <el-checkbox label="éƒ¨é—¨" />
      </el-checkbox-group>
    </el-form-item>
    
    <!-- æŒ‡æ ‡é€‰æ‹© -->
    <el-form-item label="åˆ†ææŒ‡æ ‡">
      <el-checkbox-group v-model="config.metrics">
        <el-checkbox label="æ•°é‡" />
        <el-checkbox label="å æ¯”" />
        <el-checkbox label="å¢é•¿ç‡" />
      </el-checkbox-group>
    </el-form-item>
    
    <!-- å›¾è¡¨ç±»å‹ -->
    <el-form-item label="å›¾è¡¨ç±»å‹">
      <el-radio-group v-model="config.chartType">
        <el-radio label="line">æŠ˜çº¿å›¾</el-radio>
        <el-radio label="bar">æŸ±çŠ¶å›¾</el-radio>
        <el-radio label="pie">é¥¼å›¾</el-radio>
      </el-radio-group>
    </el-form-item>
    
    <!-- é¢„è§ˆå’Œç”Ÿæˆ -->
    <el-button type="primary" @click="generateReport">ç”ŸæˆæŠ¥è¡¨</el-button>
  </div>
</template>
```

**é¢„æœŸæˆæœ**:
- æ”¯æŒ10+ç§æŠ¥è¡¨ç±»å‹
- æŠ¥è¡¨ç”Ÿæˆæ—¶é—´ < 5ç§’
- æ”¯æŒç™¾ä¸‡çº§æ•°æ®åˆ†æ

---

### ä¸­ä¼˜å…ˆçº§ (2-3ä¸ªæœˆå®Œæˆ)

#### 4. æ–‡æ¡£åœ¨çº¿é¢„è§ˆå¢å¼º â­â­â­â­
**å½“å‰çŠ¶æ€**: åŸºç¡€æ–‡ä»¶ä¸Šä¼ ä¸‹è½½  
**ä¸šåŠ¡ä»·å€¼**: æé«˜æŸ¥é˜…æ•ˆç‡  
**æŠ€æœ¯éš¾åº¦**: â­â­â­â­

**éœ€è¦å®ç°çš„åŠŸèƒ½**:
- [ ] PDFåœ¨çº¿é¢„è§ˆ
- [ ] Officeæ–‡æ¡£é¢„è§ˆ (Word, Excel, PPT)
- [ ] å›¾ç‰‡é¢„è§ˆå’Œç¼©æ”¾
- [ ] è§†é¢‘é¢„è§ˆ
- [ ] æ–‡æ¡£æ°´å°
- [ ] æ–‡æ¡£ç‰ˆæœ¬æ§åˆ¶
- [ ] æ–‡æ¡£å¯¹æ¯”åŠŸèƒ½
- [ ] æ–‡æ¡£æ‰¹æ³¨åŠŸèƒ½ (å¯é€‰)

**æŠ€æœ¯æ–¹æ¡ˆé€‰å‹**:

| æ–¹æ¡ˆ | ä¼˜ç‚¹ | ç¼ºç‚¹ | æ¨èåº¦ |
|------|------|------|--------|
| **PDF.js** | å¼€æºå…è´¹ï¼ŒåŠŸèƒ½å®Œå–„ | ä»…æ”¯æŒPDF | â­â­â­â­â­ |
| **Office Online** | å¾®è½¯å®˜æ–¹ï¼Œæ”¯æŒå…¨æ ¼å¼ | éœ€è¦Office 365æˆæƒ | â­â­â­ |
| **LibreOfficeåœ¨çº¿** | å¼€æºï¼Œæ”¯æŒOfficeæ ¼å¼ | æ€§èƒ½ä¸€èˆ¬ï¼Œéƒ¨ç½²å¤æ‚ | â­â­â­ |
| **ONLYOFFICE** | åŠŸèƒ½å¼ºå¤§ï¼ŒUIç¾è§‚ | ç¤¾åŒºç‰ˆæœ‰é™åˆ¶ | â­â­â­â­ |
| **æ°¸ä¸­Office** | å›½äº§æ–¹æ¡ˆï¼Œå…¼å®¹æ€§å¥½ | éœ€è¦å•†ä¸šæˆæƒ | â­â­â­ |

**æ¨èæ–¹æ¡ˆ**: PDF.js (PDF) + ONLYOFFICEç¤¾åŒºç‰ˆ (Officeæ–‡æ¡£)

**æŠ€æœ¯å®ç°**:
```java
// æ–‡æ¡£é¢„è§ˆæœåŠ¡
@Service
public class DocumentPreviewService {
    
    public PreviewUrl generatePreviewUrl(Long fileId) {
        ArchiveFile file = fileService.getById(fileId);
        String fileType = getFileType(file.getFileName());
        
        switch (fileType) {
            case "pdf":
                return generatePdfPreview(file);
            case "doc", "docx":
                return generateWordPreview(file);
            case "xls", "xlsx":
                return generateExcelPreview(file);
            case "ppt", "pptx":
                return generatePptPreview(file);
            default:
                throw new UnsupportedFileTypeException(fileType);
        }
    }
    
    private PreviewUrl generatePdfPreview(ArchiveFile file) {
        // ä½¿ç”¨PDF.js
        return PreviewUrl.builder()
            .url("/pdfjs/web/viewer.html?file=" + file.getStoragePath())
            .type("pdf")
            .build();
    }
    
    private PreviewUrl generateWordPreview(ArchiveFile file) {
        // è½¬æ¢ä¸ºPDFæˆ–ä½¿ç”¨ONLYOFFICE
        String convertedPath = convertToPdf(file);
        return PreviewUrl.builder()
            .url(convertedPath)
            .type("office")
            .build();
    }
}
```

**å‰ç«¯é¢„è§ˆç»„ä»¶**:
```vue
<template>
  <div class="document-preview">
    <!-- PDFé¢„è§ˆ -->
    <iframe 
      v-if="fileType === 'pdf'" 
      :src="previewUrl" 
      class="preview-iframe"
    />
    
    <!-- Officeæ–‡æ¡£é¢„è§ˆ -->
    <div v-else-if="isOfficeFile" id="onlyoffice-container" />
    
    <!-- å›¾ç‰‡é¢„è§ˆ -->
    <el-image 
      v-else-if="isImage" 
      :src="previewUrl" 
      :preview-src-list="[previewUrl]"
      fit="contain"
    />
    
    <!-- ä¸æ”¯æŒé¢„è§ˆ -->
    <div v-else class="no-preview">
      <el-icon><DocumentDelete /></el-icon>
      <p>è¯¥æ–‡ä»¶ç±»å‹ä¸æ”¯æŒåœ¨çº¿é¢„è§ˆ</p>
      <el-button @click="download">ä¸‹è½½æ–‡ä»¶</el-button>
    </div>
  </div>
</template>
```

**é¢„æœŸæˆæœ**:
- æ”¯æŒæ–‡ä»¶æ ¼å¼: PDF, Word, Excel, PPT, å›¾ç‰‡
- é¢„è§ˆåŠ è½½æ—¶é—´ < 3ç§’
- é¢„è§ˆæˆåŠŸç‡ > 95%

#### 5. å…¨æ–‡æ£€ç´¢ä¼˜åŒ– â­â­â­â­
**å½“å‰çŠ¶æ€**: åŸºç¡€æ•°æ®åº“æœç´¢  
**ä¸šåŠ¡ä»·å€¼**: æé«˜æ£€ç´¢æ•ˆç‡å’Œå‡†ç¡®æ€§  
**æŠ€æœ¯éš¾åº¦**: â­â­â­â­

**éœ€è¦å®ç°çš„åŠŸèƒ½**:
- [ ] Elasticsearché›†æˆ
- [ ] ä¸­æ–‡åˆ†è¯ (IK Analyzer)
- [ ] å…¨æ–‡ç´¢å¼•æ„å»º
- [ ] é«˜äº®æ˜¾ç¤º
- [ ] æ¨¡ç³Šæœç´¢
- [ ] æœç´¢å»ºè®®
- [ ] æœç´¢å†å²
- [ ] çƒ­é—¨æœç´¢

**æŠ€æœ¯å®ç°**:
```java
// Elasticsearché…ç½®
@Configuration
public class ElasticsearchConfig {
    @Bean
    public RestHighLevelClient client() {
        return new RestHighLevelClient(
            RestClient.builder(
                new HttpHost("localhost", 9200, "http")
            )
        );
    }
}

// å…¨æ–‡æ£€ç´¢æœåŠ¡
@Service
public class FullTextSearchService {
    
    @Autowired
    private RestHighLevelClient client;
    
    public SearchResult search(String keyword, int page, int size) {
        SearchRequest request = new SearchRequest("archives");
        SearchSourceBuilder builder = new SearchSourceBuilder();
        
        // å¤šå­—æ®µæœç´¢
        builder.query(QueryBuilders.multiMatchQuery(keyword, 
            "title", "content", "keywords", "description")
            .analyzer("ik_smart")
        );
        
        // é«˜äº®è®¾ç½®
        builder.highlighter(new HighlightBuilder()
            .field("title")
            .field("content")
            .preTags("<em class='highlight'>")
            .postTags("</em>")
        );
        
        // åˆ†é¡µ
        builder.from(page * size).size(size);
        
        // æ‰§è¡Œæœç´¢
        SearchResponse response = client.search(request, RequestOptions.DEFAULT);
        
        return parseSearchResult(response);
    }
    
    public List<String> getSuggestions(String prefix) {
        // æœç´¢å»ºè®®
        CompletionSuggestionBuilder suggestion = 
            SuggestBuilders.completionSuggestion("title.suggest")
                .prefix(prefix)
                .size(10);
        
        // æ‰§è¡Œå»ºè®®æŸ¥è¯¢
        // ...
        
        return suggestions;
    }
}
```

**é¢„æœŸæˆæœ**:
- æœç´¢å“åº”æ—¶é—´ < 200ms
- æ”¯æŒåƒä¸‡çº§æ•°æ®æ£€ç´¢
- æœç´¢å‡†ç¡®ç‡ > 90%

#### 6. ç³»ç»Ÿé›†æˆèƒ½åŠ› â­â­â­
**å½“å‰çŠ¶æ€**: ç‹¬ç«‹ç³»ç»Ÿ  
**ä¸šåŠ¡ä»·å€¼**: ä¸ä¼ä¸šç°æœ‰ç³»ç»Ÿæ‰“é€š  
**æŠ€æœ¯éš¾åº¦**: â­â­â­

**éœ€è¦å®ç°çš„åŠŸèƒ½**:
- [ ] å•ç‚¹ç™»å½• (SSO) - CAS/OAuth2
- [ ] APIç½‘å…³é›†æˆ
- [ ] ä¼ä¸šå¾®ä¿¡é›†æˆ
- [ ] é’‰é’‰é›†æˆ
- [ ] LDAP/ADåŸŸé›†æˆ
- [ ] Webhooké€šçŸ¥
- [ ] å¼€æ”¾APIæ–‡æ¡£ (Swagger)
- [ ] APIç‰ˆæœ¬ç®¡ç†

**æŠ€æœ¯å®ç°**:
```java
// OAuth2é…ç½®
@Configuration
@EnableAuthorizationServer
public class OAuth2Config extends AuthorizationServerConfigurerAdapter {
    
    @Override
    public void configure(ClientDetailsServiceConfigurer clients) throws Exception {
        clients.inMemory()
            .withClient("archive-client")
            .secret("{noop}secret")
            .authorizedGrantTypes("authorization_code", "refresh_token")
            .scopes("read", "write")
            .redirectUris("http://localhost:3000/callback");
    }
}

// ä¼ä¸šå¾®ä¿¡é›†æˆ
@Service
public class WeChatWorkIntegrationService {
    
    public void sendMessage(Long userId, String message) {
        // è°ƒç”¨ä¼ä¸šå¾®ä¿¡APIå‘é€æ¶ˆæ¯
        WeChatWorkClient client = new WeChatWorkClient(corpId, corpSecret);
        client.sendTextMessage(userId, message);
    }
    
    public UserInfo syncUser(String wechatUserId) {
        // åŒæ­¥ä¼ä¸šå¾®ä¿¡ç”¨æˆ·ä¿¡æ¯
        WeChatUser wechatUser = client.getUserInfo(wechatUserId);
        return convertToSystemUser(wechatUser);
    }
}
```

**é¢„æœŸæˆæœ**:
- æ”¯æŒ3+ç§SSOæ–¹æ¡ˆ
- æ”¯æŒä¼ä¸šå¾®ä¿¡/é’‰é’‰æ¶ˆæ¯æ¨é€
- APIæ–‡æ¡£è¦†ç›–ç‡100%

---

### ä½ä¼˜å…ˆçº§ (3-6ä¸ªæœˆå®Œæˆ)

#### 7. æ™ºèƒ½åŒ–åŠŸèƒ½ â­â­â­
**å½“å‰çŠ¶æ€**: æ—   
**ä¸šåŠ¡ä»·å€¼**: æå‡è‡ªåŠ¨åŒ–æ°´å¹³  
**æŠ€æœ¯éš¾åº¦**: â­â­â­â­â­

**éœ€è¦å®ç°çš„åŠŸèƒ½**:
- [ ] OCRæ–‡å­—è¯†åˆ«
- [ ] æ™ºèƒ½åˆ†ç±»æ¨è
- [ ] æ™ºèƒ½æ ‡ç­¾ç”Ÿæˆ
- [ ] æ™ºèƒ½æŸ¥é‡
- [ ] æ™ºèƒ½æ‘˜è¦ç”Ÿæˆ
- [ ] æ¡£æ¡ˆå…³è”æ¨è

**æŠ€æœ¯æ–¹æ¡ˆ**:
- **OCRæœåŠ¡**: ç™¾åº¦OCR / è…¾è®¯OCR / Tesseract (å¼€æº)
- **NLPæœåŠ¡**: ç™¾åº¦AI / é˜¿é‡Œäº‘NLP / è‡ªå»ºæ¨¡å‹
- **æ¨èç®—æ³•**: ååŒè¿‡æ»¤ / å†…å®¹æ¨è

#### 8. é«˜çº§å®‰å…¨åŠŸèƒ½ â­â­â­
**éœ€è¦å®ç°çš„åŠŸèƒ½**:
- [ ] æ•°æ®è„±æ•
- [ ] æ•°æ®åŠ å¯†å­˜å‚¨
- [ ] è®¿é—®æ§åˆ¶ç»†åŒ– (å­—æ®µçº§æƒé™)
- [ ] é˜²ç¯¡æ”¹æœºåˆ¶ (åŒºå—é“¾/æ•°å­—ç­¾å)
- [ ] å®‰å…¨å®¡è®¡å¢å¼º
- [ ] IPç™½åå•
- [ ] åŒå› ç´ è®¤è¯ (2FA)

#### 9. ç”¨æˆ·ä½“éªŒä¼˜åŒ– â­â­
**éœ€è¦å®ç°çš„åŠŸèƒ½**:
- [ ] ç•Œé¢ä¸»é¢˜å®šåˆ¶ (äº®è‰²/æš—è‰²)
- [ ] å¿«æ·é”®æ”¯æŒ
- [ ] æ‹–æ‹½ä¸Šä¼ 
- [ ] æ‰¹é‡æ‹–æ‹½æ’åº
- [ ] ä¸ªæ€§åŒ–æ¡Œé¢
- [ ] æ“ä½œå¼•å¯¼å’Œå¸®åŠ©æ–‡æ¡£

---

## ğŸ›  æŠ€æœ¯ä¼˜åŒ–å»ºè®®

### 1. æ¶æ„ä¼˜åŒ–

#### å¼•å…¥æ¶ˆæ¯é˜Ÿåˆ—
**ç›®çš„**: å¼‚æ­¥å¤„ç†ã€ç³»ç»Ÿè§£è€¦  
**æ¨èæ–¹æ¡ˆ**: RabbitMQ / Redis Stream / Kafka

```java
// RabbitMQé…ç½®
@Configuration
public class RabbitMQConfig {
    
    @Bean
    public Queue notificationQueue() {
        return new Queue("archive.notification", true);
    }
    
    @Bean
    public Queue exportQueue() {
        return new Queue("archive.export", true);
    }
    
    @Bean
    public TopicExchange exchange() {
        return new TopicExchange("archive.topic");
    }
}

// å¼‚æ­¥æ¶ˆæ¯ç”Ÿäº§è€…
@Service
public class AsyncTaskProducer {
    
    @Autowired
    private RabbitTemplate rabbitTemplate;
    
    public void sendExportTask(ExportTask task) {
        rabbitTemplate.convertAndSend(
            "archive.topic", 
            "export.task", 
            task
        );
    }
}

// æ¶ˆæ¯æ¶ˆè´¹è€…
@Component
public class ExportTaskConsumer {
    
    @RabbitListener(queues = "archive.export")
    public void handleExportTask(ExportTask task) {
        // å¤„ç†å¯¼å‡ºä»»åŠ¡
        exportService.process(task);
    }
}
```

#### ç¼“å­˜ç­–ç•¥ä¼˜åŒ–
**ç›®çš„**: æå‡æ€§èƒ½ã€å‡å°‘æ•°æ®åº“å‹åŠ›  
**æ¨èæ–¹æ¡ˆ**: Rediså¤šçº§ç¼“å­˜

```java
// å¤šçº§ç¼“å­˜é…ç½®
@Configuration
@EnableCaching
public class CacheConfig {
    
    @Bean
    public CacheManager cacheManager(RedisConnectionFactory factory) {
        RedisCacheConfiguration config = RedisCacheConfiguration.defaultCacheConfig()
            .entryTtl(Duration.ofMinutes(10))
            .serializeKeysWith(RedisSerializationContext.SerializationPair
                .fromSerializer(new StringRedisSerializer()))
            .serializeValuesWith(RedisSerializationContext.SerializationPair
                .fromSerializer(new GenericJackson2JsonRedisSerializer()));
        
        return RedisCacheManager.builder(factory)
            .cacheDefaults(config)
            .withCacheConfiguration("archive", config.entryTtl(Duration.ofHours(1)))
            .withCacheConfiguration("user", config.entryTtl(Duration.ofMinutes(30)))
            .withCacheConfiguration("config", config.entryTtl(Duration.ofHours(24)))
            .build();
    }
}

// ç¼“å­˜ä½¿ç”¨ç¤ºä¾‹
@Service
public class ArchiveService {
    
    @Cacheable(value = "archive", key = "#id")
    public Archive getById(Long id) {
        return archiveMapper.selectById(id);
    }
    
    @CacheEvict(value = "archive", key = "#archive.id")
    public void update(Archive archive) {
        archiveMapper.updateById(archive);
    }
    
    @Caching(evict = {
        @CacheEvict(value = "archive", allEntries = true),
        @CacheEvict(value = "statistics", allEntries = true)
    })
    public void clearCache() {
        // æ¸…é™¤æ‰€æœ‰ç¼“å­˜
    }
}
```

#### æ•°æ®åº“ä¼˜åŒ–
**ç›®çš„**: æå‡æŸ¥è¯¢æ€§èƒ½

```sql
-- ç´¢å¼•ä¼˜åŒ–
CREATE INDEX idx_archive_category_status ON archive(category_id, status);
CREATE INDEX idx_archive_created_time ON archive(created_time);
CREATE INDEX idx_borrow_user_status ON borrow_record(user_id, status);
CREATE INDEX idx_borrow_archive_return_time ON borrow_record(archive_id, return_time);

-- åˆ†åŒºè¡¨ (é’ˆå¯¹å¤§æ•°æ®é‡)
ALTER TABLE archive_log PARTITION BY RANGE (YEAR(created_time)) (
    PARTITION p2023 VALUES LESS THAN (2024),
    PARTITION p2024 VALUES LESS THAN (2025),
    PARTITION p2025 VALUES LESS THAN (2026),
    PARTITION pmax VALUES LESS THAN MAXVALUE
);

-- è¯»å†™åˆ†ç¦»é…ç½® (MyBatis-Plus)
@Configuration
public class DataSourceConfig {
    
    @Bean
    @ConfigurationProperties("spring.datasource.master")
    public DataSource masterDataSource() {
        return DataSourceBuilder.create().build();
    }
    
    @Bean
    @ConfigurationProperties("spring.datasource.slave")
    public DataSource slaveDataSource() {
        return DataSourceBuilder.create().build();
    }
    
    @Bean
    public DataSource dynamicDataSource() {
        Map<Object, Object> targetDataSources = new HashMap<>();
        targetDataSources.put("master", masterDataSource());
        targetDataSources.put("slave", slaveDataSource());
        
        DynamicRoutingDataSource dataSource = new DynamicRoutingDataSource();
        dataSource.setTargetDataSources(targetDataSources);
        dataSource.setDefaultTargetDataSource(masterDataSource());
        
        return dataSource;
    }
}
```

### 2. æ€§èƒ½ä¼˜åŒ–

#### å‰ç«¯æ€§èƒ½ä¼˜åŒ–
```typescript
// è·¯ç”±æ‡’åŠ è½½
const routes = [
  {
    path: '/archive',
    component: () => import('@/pages/archive/List.vue')
  }
];

// ç»„ä»¶æ‡’åŠ è½½
const ArchiveForm = defineAsyncComponent(() => 
  import('@/components/ArchiveForm.vue')
);

// å›¾ç‰‡æ‡’åŠ è½½
<img v-lazy="imageUrl" />

// è™šæ‹Ÿæ»šåŠ¨ (å¤§åˆ—è¡¨)
import { VirtualScroller } from 'vue-virtual-scroller';

<virtual-scroller
  :items="largeList"
  :item-size="50"
  key-field="id"
>
  <template #default="{ item }">
    <div class="item">{{ item.name }}</div>
  </template>
</virtual-scroller>
```

#### åç«¯æ€§èƒ½ä¼˜åŒ–
```java
// æ‰¹é‡æ“ä½œä¼˜åŒ–
@Service
public class BatchService {
    
    @Transactional
    public void batchInsert(List<Archive> archives) {
        // ä½¿ç”¨æ‰¹é‡æ’å…¥ï¼Œæ¯æ¬¡1000æ¡
        int batchSize = 1000;
        for (int i = 0; i < archives.size(); i += batchSize) {
            int end = Math.min(i + batchSize, archives.size());
            archiveMapper.batchInsert(archives.subList(i, end));
        }
    }
}

// å¼‚æ­¥ä»»åŠ¡
@Service
public class AsyncService {
    
    @Async
    public CompletableFuture<ExportResult> exportAsync(ExportRequest request) {
        ExportResult result = exportService.export(request);
        return CompletableFuture.completedFuture(result);
    }
}

// SQLæŸ¥è¯¢ä¼˜åŒ–
@Select("SELECT a.*, c.name as category_name " +
        "FROM archive a " +
        "LEFT JOIN category c ON a.category_id = c.id " +
        "WHERE a.status = #{status} " +
        "LIMIT #{offset}, #{limit}")
List<ArchiveVO> selectWithPagination(@Param("status") String status,
                                      @Param("offset") int offset,
                                      @Param("limit") int limit);
```

### 3. å®‰å…¨ä¼˜åŒ–

```java
// XSSé˜²æŠ¤
@Configuration
public class XssConfig {
    
    @Bean
    public FilterRegistrationBean<XssFilter> xssFilterRegistration() {
        FilterRegistrationBean<XssFilter> registration = new FilterRegistrationBean<>();
        registration.setFilter(new XssFilter());
        registration.addUrlPatterns("/*");
        registration.setName("xssFilter");
        registration.setOrder(1);
        return registration;
    }
}

// CSRFé˜²æŠ¤
@Configuration
public class SecurityConfig extends WebSecurityConfigurerAdapter {
    
    @Override
    protected void configure(HttpSecurity http) throws Exception {
        http.csrf()
            .csrfTokenRepository(CookieCsrfTokenRepository.withHttpOnlyFalse());
    }
}

// SQLæ³¨å…¥é˜²æŠ¤ (ä½¿ç”¨PreparedStatement)
@Select("SELECT * FROM archive WHERE id = #{id}")
Archive selectById(@Param("id") Long id);

// æ•æ„Ÿæ•°æ®åŠ å¯†
@Service
public class EncryptionService {
    
    private static final String ALGORITHM = "AES";
    private static final String KEY = "your-secret-key";
    
    public String encrypt(String data) {
        // AESåŠ å¯†å®ç°
    }
    
    public String decrypt(String encryptedData) {
        // AESè§£å¯†å®ç°
    }
}
```

---

## ğŸ“‹ å®æ–½è®¡åˆ’ä¸æ—¶é—´è¡¨

### ç¬¬ä¸€é˜¶æ®µ: åŸºç¡€å¢å¼º (1-2ä¸ªæœˆ)

| ä»»åŠ¡ | ä¼˜å…ˆçº§ | é¢„è®¡å·¥æ—¶ | è´Ÿè´£äºº | å¼€å§‹æ—¥æœŸ | ç»“æŸæ—¥æœŸ |
|------|--------|----------|--------|----------|----------|
| WebSocketå®æ—¶é€šçŸ¥ | P0 | 40å°æ—¶ | åç«¯å·¥ç¨‹å¸ˆ | ç¬¬1å‘¨ | ç¬¬2å‘¨ |
| æ¶ˆæ¯ä¸­å¿ƒUI | P0 | 24å°æ—¶ | å‰ç«¯å·¥ç¨‹å¸ˆ | ç¬¬2å‘¨ | ç¬¬3å‘¨ |
| ç§»åŠ¨ç«¯å“åº”å¼é€‚é… | P0 | 80å°æ—¶ | å‰ç«¯å·¥ç¨‹å¸ˆ | ç¬¬3å‘¨ | ç¬¬6å‘¨ |
| æŠ¥è¡¨ç³»ç»ŸåŸºç¡€ | P1 | 60å°æ—¶ | å…¨æ ˆå·¥ç¨‹å¸ˆ | ç¬¬4å‘¨ | ç¬¬7å‘¨ |
| æ€§èƒ½ä¼˜åŒ– | P1 | 40å°æ—¶ | åç«¯å·¥ç¨‹å¸ˆ | ç¬¬5å‘¨ | ç¬¬7å‘¨ |

**ç¬¬ä¸€é˜¶æ®µç›®æ ‡**:
- âœ… å®æ—¶é€šçŸ¥ç³»ç»Ÿä¸Šçº¿
- âœ… ç§»åŠ¨ç«¯è®¿é—®ä½“éªŒè‰¯å¥½
- âœ… åŸºç¡€æŠ¥è¡¨åŠŸèƒ½å¯ç”¨
- âœ… ç³»ç»Ÿæ€§èƒ½æå‡30%

### ç¬¬äºŒé˜¶æ®µ: åŠŸèƒ½æ·±åŒ– (2-3ä¸ªæœˆ)

| ä»»åŠ¡ | ä¼˜å…ˆçº§ | é¢„è®¡å·¥æ—¶ | è´Ÿè´£äºº | å¼€å§‹æ—¥æœŸ | ç»“æŸæ—¥æœŸ |
|------|--------|----------|--------|----------|----------|
| æ–‡æ¡£åœ¨çº¿é¢„è§ˆ | P1 | 60å°æ—¶ | å…¨æ ˆå·¥ç¨‹å¸ˆ | ç¬¬8å‘¨ | ç¬¬11å‘¨ |
| Elasticsearché›†æˆ | P1 | 50å°æ—¶ | åç«¯å·¥ç¨‹å¸ˆ | ç¬¬9å‘¨ | ç¬¬12å‘¨ |
| ç³»ç»Ÿé›†æˆ(SSO) | P2 | 40å°æ—¶ | åç«¯å·¥ç¨‹å¸ˆ | ç¬¬10å‘¨ | ç¬¬12å‘¨ |
| æŠ¥è¡¨ç³»ç»Ÿé«˜çº§åŠŸèƒ½ | P1 | 40å°æ—¶ | å‰ç«¯å·¥ç¨‹å¸ˆ | ç¬¬11å‘¨ | ç¬¬13å‘¨ |

**ç¬¬äºŒé˜¶æ®µç›®æ ‡**:
- âœ… æ–‡æ¡£é¢„è§ˆæ”¯æŒä¸»æµæ ¼å¼
- âœ… å…¨æ–‡æ£€ç´¢åŠŸèƒ½ä¸Šçº¿
- âœ… SSOé›†æˆå®Œæˆ
- âœ… é«˜çº§æŠ¥è¡¨åŠŸèƒ½å®Œå–„

### ç¬¬ä¸‰é˜¶æ®µ: æ™ºèƒ½åŒ–å‡çº§ (3-6ä¸ªæœˆ)

| ä»»åŠ¡ | ä¼˜å…ˆçº§ | é¢„è®¡å·¥æ—¶ | è´Ÿè´£äºº | å¼€å§‹æ—¥æœŸ | ç»“æŸæ—¥æœŸ |
|------|--------|----------|--------|----------|----------|
| OCRæ–‡å­—è¯†åˆ« | P2 | 50å°æ—¶ | AIå·¥ç¨‹å¸ˆ | ç¬¬14å‘¨ | ç¬¬17å‘¨ |
| æ™ºèƒ½åˆ†ç±» | P2 | 60å°æ—¶ | AIå·¥ç¨‹å¸ˆ | ç¬¬15å‘¨ | ç¬¬19å‘¨ |
| é«˜çº§å®‰å…¨åŠŸèƒ½ | P2 | 40å°æ—¶ | å®‰å…¨å·¥ç¨‹å¸ˆ | ç¬¬16å‘¨ | ç¬¬19å‘¨ |
| ç”¨æˆ·ä½“éªŒä¼˜åŒ– | P3 | 30å°æ—¶ | UI/UXè®¾è®¡å¸ˆ | ç¬¬18å‘¨ | ç¬¬20å‘¨ |

**ç¬¬ä¸‰é˜¶æ®µç›®æ ‡**:
- âœ… æ™ºèƒ½åŒ–åŠŸèƒ½åˆæ­¥å¯ç”¨
- âœ… å®‰å…¨æ€§è¿›ä¸€æ­¥æå‡
- âœ… ç”¨æˆ·ä½“éªŒæŒç»­ä¼˜åŒ–

---

## ğŸ’° èµ„æºéœ€æ±‚è¯„ä¼°

### äººåŠ›èµ„æºéœ€æ±‚

#### ç¬¬ä¸€é˜¶æ®µå›¢é˜Ÿ
- **åç«¯å¼€å‘å·¥ç¨‹å¸ˆ**: 2äºº (é«˜çº§1äºº + ä¸­çº§1äºº)
  - æŠ€èƒ½è¦æ±‚: Spring Boot, Redis, WebSocket, MySQLä¼˜åŒ–
  - æœˆè–ªé¢„ç®—: 2.5ä¸‡ + 1.8ä¸‡ = 4.3ä¸‡
  
- **å‰ç«¯å¼€å‘å·¥ç¨‹å¸ˆ**: 2äºº (é«˜çº§1äºº + ä¸­çº§1äºº)
  - æŠ€èƒ½è¦æ±‚: Vue 3, TypeScript, å“åº”å¼è®¾è®¡, ECharts
  - æœˆè–ªé¢„ç®—: 2.2ä¸‡ + 1.6ä¸‡ = 3.8ä¸‡
  
- **æµ‹è¯•å·¥ç¨‹å¸ˆ**: 1äºº
  - æŠ€èƒ½è¦æ±‚: è‡ªåŠ¨åŒ–æµ‹è¯•, æ€§èƒ½æµ‹è¯•
  - æœˆè–ªé¢„ç®—: 1.5ä¸‡

**ç¬¬ä¸€é˜¶æ®µäººåŠ›æˆæœ¬**: (4.3 + 3.8 + 1.5) Ã— 2ä¸ªæœˆ = **19.2ä¸‡å…ƒ**

#### ç¬¬äºŒé˜¶æ®µå›¢é˜Ÿ (ç´¯åŠ )
- **å…¨æ ˆå·¥ç¨‹å¸ˆ**: 1äºº
  - æŠ€èƒ½è¦æ±‚: å‰åç«¯å¼€å‘, ç³»ç»Ÿé›†æˆ
  - æœˆè–ªé¢„ç®—: 2.5ä¸‡
  
- **DevOpså·¥ç¨‹å¸ˆ**: 1äºº
  - æŠ€èƒ½è¦æ±‚: Elasticsearch, Docker, K8s
  - æœˆè–ªé¢„ç®—: 2.2ä¸‡

**ç¬¬äºŒé˜¶æ®µäººåŠ›æˆæœ¬**: (9.7 + 2.5 + 2.2) Ã— 3ä¸ªæœˆ = **43.2ä¸‡å…ƒ**

#### ç¬¬ä¸‰é˜¶æ®µå›¢é˜Ÿ (ç´¯åŠ )
- **AIå·¥ç¨‹å¸ˆ**: 1äºº
  - æŠ€èƒ½è¦æ±‚: OCR, NLP, æ¨èç®—æ³•
  - æœˆè–ªé¢„ç®—: 3.0ä¸‡
  
- **å®‰å…¨å·¥ç¨‹å¸ˆ**: 1äºº
  - æŠ€èƒ½è¦æ±‚: å®‰å…¨å®¡è®¡, åŠ å¯†æŠ€æœ¯
  - æœˆè–ªé¢„ç®—: 2.5ä¸‡
  
- **UI/UXè®¾è®¡å¸ˆ**: 1äºº
  - æŠ€èƒ½è¦æ±‚: ç•Œé¢è®¾è®¡, ç”¨æˆ·ä½“éªŒ
  - æœˆè–ªé¢„ç®—: 1.8ä¸‡

**ç¬¬ä¸‰é˜¶æ®µäººåŠ›æˆæœ¬**: (14.4 + 3.0 + 2.5 + 1.8) Ã— 4ä¸ªæœˆ = **87.8ä¸‡å…ƒ**

**æ€»äººåŠ›æˆæœ¬**: 19.2 + 43.2 + 87.8 = **150.2ä¸‡å…ƒ**

### æŠ€æœ¯èµ„æºéœ€æ±‚

#### äº‘æœåŠ¡å™¨
| ç¯å¢ƒ | é…ç½® | æ•°é‡ | å•ä»·/æœˆ | æ€»ä»·/å¹´ |
|------|------|------|---------|---------|
| å¼€å‘ç¯å¢ƒ | 4æ ¸8G | 2å° | 200å…ƒ | 4,800å…ƒ |
| æµ‹è¯•ç¯å¢ƒ | 8æ ¸16G | 2å° | 500å…ƒ | 12,000å…ƒ |
| ç”Ÿäº§ç¯å¢ƒ | 16æ ¸32G | 3å° | 1,200å…ƒ | 43,200å…ƒ |
| æ•°æ®åº“ | MySQLé«˜å¯ç”¨ | 1å¥— | 800å…ƒ | 9,600å…ƒ |
| Redisé›†ç¾¤ | 8Gå†…å­˜ | 1å¥— | 300å…ƒ | 3,600å…ƒ |
| Elasticsearch | 3èŠ‚ç‚¹ | 1å¥— | 600å…ƒ | 7,200å…ƒ |
| **å°è®¡** | - | - | - | **80,400å…ƒ/å¹´** |

#### ç¬¬ä¸‰æ–¹æœåŠ¡
| æœåŠ¡ | ç”¨é€” | é¢„è®¡ç”¨é‡ | å•ä»· | æ€»ä»·/å¹´ |
|------|------|----------|------|---------|
| ç™¾åº¦OCR | æ–‡å­—è¯†åˆ« | 10ä¸‡æ¬¡/æœˆ | 500å…ƒ/ä¸‡æ¬¡ | 60,000å…ƒ |
| é˜¿é‡Œäº‘çŸ­ä¿¡ | çŸ­ä¿¡é€šçŸ¥ | 5åƒæ¡/æœˆ | 0.05å…ƒ/æ¡ | 3,000å…ƒ |
| è…¾è®¯äº‘é‚®ä»¶ | é‚®ä»¶æ¨é€ | 5ä¸‡å°/æœˆ | 0.002å…ƒ/å° | 1,200å…ƒ |
| CDNåŠ é€Ÿ | é™æ€èµ„æº | 500GB/æœˆ | 0.2å…ƒ/GB | 1,200å…ƒ |
| OSSå­˜å‚¨ | æ–‡ä»¶å­˜å‚¨ | 2TB | 0.12å…ƒ/GB/æœˆ | 2,880å…ƒ |
| **å°è®¡** | - | - | - | **68,280å…ƒ/å¹´** |

#### è½¯ä»¶æˆæƒ
| è½¯ä»¶ | ç”¨é€” | æ•°é‡ | å•ä»· | æ€»ä»· |
|------|------|------|------|------|
| ONLYOFFICE | æ–‡æ¡£é¢„è§ˆ | 10ç”¨æˆ· | å…è´¹ | 0å…ƒ |
| JetBrainså…¨å®¶æ¡¶ | å¼€å‘å·¥å…· | 8ä»½ | 1,000å…ƒ/å¹´ | 8,000å…ƒ |
| **å°è®¡** | - | - | - | **8,000å…ƒ** |

**æ€»æŠ€æœ¯æˆæœ¬**: 80,400 + 68,280 + 8,000 = **156,680å…ƒ**

### æ€»æˆæœ¬æ±‡æ€»
- **äººåŠ›æˆæœ¬**: 150.2ä¸‡å…ƒ
- **æŠ€æœ¯æˆæœ¬**: 15.7ä¸‡å…ƒ
- **å…¶ä»–æˆæœ¬** (åŸ¹è®­ã€å·®æ—…ç­‰): 5ä¸‡å…ƒ
- **æ€»æˆæœ¬**: **170.9ä¸‡å…ƒ**

---

## ğŸ“Š é¢„æœŸæ”¶ç›Šåˆ†æ

### ç”¨æˆ·å¢é•¿é¢„æœŸ
- **ç¬¬ä¸€é˜¶æ®µå**: ç§»åŠ¨ç«¯ç”¨æˆ·å¢é•¿30%
- **ç¬¬äºŒé˜¶æ®µå**: ä¼ä¸šå®¢æˆ·å¢é•¿40%
- **ç¬¬ä¸‰é˜¶æ®µå**: æ€»ç”¨æˆ·æ•°å¢é•¿100%

### æ”¶å…¥å¢é•¿é¢„æœŸ
- **SaaSè®¢é˜…**: æœˆæ´»ç”¨æˆ· Ã— 10å…ƒ/æœˆ = æ–°å¢æ”¶å…¥
- **ä¼ä¸šå®šåˆ¶**: 5ä¸ªä¼ä¸šå®¢æˆ· Ã— 10ä¸‡å…ƒ = 50ä¸‡å…ƒ
- **æŠ€æœ¯æœåŠ¡**: å¹´æœåŠ¡è´¹ 30ä¸‡å…ƒ

**é¢„è®¡å¹´æ”¶å…¥å¢é•¿**: **80-120ä¸‡å…ƒ**

### ROIåˆ†æ
- **æŠ•èµ„æˆæœ¬**: 170.9ä¸‡å…ƒ
- **é¢„æœŸæ”¶ç›Š**: 80-120ä¸‡å…ƒ/å¹´
- **æŠ•èµ„å›æŠ¥å‘¨æœŸ**: 18-24ä¸ªæœˆ
- **3å¹´æ€»æ”¶ç›Š**: 240-360ä¸‡å…ƒ
- **3å¹´ROI**: 140%-210%

---

## âœ… æˆåŠŸæŒ‡æ ‡ (KPI)

### æŠ€æœ¯æŒ‡æ ‡
- [ ] ç³»ç»Ÿå“åº”æ—¶é—´ < 200ms
- [ ] ç³»ç»Ÿå¯ç”¨æ€§ > 99.9%
- [ ] é¡µé¢åŠ è½½æ—¶é—´ < 3ç§’
- [ ] ç§»åŠ¨ç«¯é€‚é…è¦†ç›–ç‡ > 95%
- [ ] APIé”™è¯¯ç‡ < 0.1%
- [ ] ä»£ç æµ‹è¯•è¦†ç›–ç‡ > 80%

### ä¸šåŠ¡æŒ‡æ ‡
- [ ] ç”¨æˆ·æ»¡æ„åº¦ > 4.5/5
- [ ] æ—¥æ´»è·ƒç”¨æˆ·å¢é•¿ > 30%
- [ ] ç”¨æˆ·ç•™å­˜ç‡ > 85%
- [ ] åŠŸèƒ½ä½¿ç”¨ç‡ > 70%
- [ ] å®¢æˆ·æµå¤±ç‡ < 5%

### æ€§èƒ½æŒ‡æ ‡
- [ ] å¹¶å‘ç”¨æˆ·æ•° > 1000
- [ ] æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ– > 50%
- [ ] ç¼“å­˜å‘½ä¸­ç‡ > 90%
- [ ] æ–‡ä»¶ä¸Šä¼ æˆåŠŸç‡ > 99%

---

## âš ï¸ é£é™©ç®¡ç†

### æŠ€æœ¯é£é™©
| é£é™© | æ¦‚ç‡ | å½±å“ | åº”å¯¹æªæ–½ |
|------|------|------|----------|
| æŠ€æœ¯é€‰å‹ä¸å½“ | ä¸­ | é«˜ | å……åˆ†è°ƒç ”å’ŒPOCéªŒè¯ |
| ç¬¬ä¸‰æ–¹æœåŠ¡æ•…éšœ | ä½ | ä¸­ | å¤šå‚å•†å¤‡ä»½æ–¹æ¡ˆ |
| æ•°æ®åº“æ€§èƒ½ç“¶é¢ˆ | ä¸­ | é«˜ | è¯»å†™åˆ†ç¦»ã€åˆ†åº“åˆ†è¡¨ |
| å®‰å…¨æ¼æ´ | ä½ | é«˜ | å®‰å…¨å®¡è®¡å’Œæ¸—é€æµ‹è¯• |

### ä¸šåŠ¡é£é™©
| é£é™© | æ¦‚ç‡ | å½±å“ | åº”å¯¹æªæ–½ |
|------|------|------|----------|
| éœ€æ±‚é¢‘ç¹å˜æ›´ | é«˜ | ä¸­ | æ•æ·å¼€å‘ã€è¿­ä»£äº¤ä»˜ |
| ç«äº‰åŠ å‰§ | ä¸­ | ä¸­ | å·®å¼‚åŒ–ç«äº‰ã€å¿«é€Ÿè¿­ä»£ |
| ç”¨æˆ·æµå¤± | ä½ | é«˜ | ç”¨æˆ·åé¦ˆæœºåˆ¶ã€æŒç»­ä¼˜åŒ– |

### èµ„æºé£é™©
| é£é™© | æ¦‚ç‡ | å½±å“ | åº”å¯¹æªæ–½ |
|------|------|------|----------|
| äººå‘˜æµå¤± | ä¸­ | é«˜ | çŸ¥è¯†æ–‡æ¡£ã€å›¢é˜Ÿå»ºè®¾ |
| é¢„ç®—è¶…æ”¯ | ä¸­ | ä¸­ | ä¸¥æ ¼æˆæœ¬æ§åˆ¶ã€åˆ†é˜¶æ®µæŠ•å…¥ |
| è¿›åº¦å»¶æœŸ | ä¸­ | ä¸­ | é‡Œç¨‹ç¢‘ç®¡ç†ã€æ•æ·å¼€å‘ |

---

## ğŸ“š å‚è€ƒèµ„æ–™

### æŠ€æœ¯æ–‡æ¡£
- [Spring Bootå®˜æ–¹æ–‡æ¡£](https://spring.io/projects/spring-boot)
- [Vue 3å®˜æ–¹æ–‡æ¡£](https://vuejs.org/)
- [Element Plusæ–‡æ¡£](https://element-plus.org/)
- [MyBatis Plusæ–‡æ¡£](https://baomidou.com/)
- [Redisæ–‡æ¡£](https://redis.io/documentation)
- [Elasticsearchæ–‡æ¡£](https://www.elastic.co/guide/)

### æœ€ä½³å®è·µ
- [é˜¿é‡Œå·´å·´Javaå¼€å‘æ‰‹å†Œ](https://github.com/alibaba/p3c)
- [Vue.jsæœ€ä½³å®è·µ](https://vuejs.org/style-guide/)
- [RESTful APIè®¾è®¡æŒ‡å—](https://restfulapi.net/)
- [æ•°æ®åº“è®¾è®¡è§„èŒƒ](https://www.mysql.com/products/enterprise/database.html)

### å·¥å…·æ¨è
- **å¼€å‘å·¥å…·**: IntelliJ IDEA, VSCode
- **æ¥å£æµ‹è¯•**: Postman, Apifox
- **æ€§èƒ½æµ‹è¯•**: JMeter, LoadRunner
- **ç›‘æ§å·¥å…·**: Prometheus, Grafana
- **æ—¥å¿—åˆ†æ**: ELK Stack
- **ä»£ç è´¨é‡**: SonarQube

---

## ğŸ¯ æ€»ç»“

### é¡¹ç›®ä¼˜åŠ¿
âœ… **æŠ€æœ¯æ¶æ„å…ˆè¿›**: Spring Boot 3 + Vue 3ï¼Œç´§è·ŸæŠ€æœ¯æ½®æµ  
âœ… **åŠŸèƒ½åŸºç¡€æ‰å®**: æ ¸å¿ƒä¸šåŠ¡åŠŸèƒ½å®Œæ•´ï¼Œä»£ç è´¨é‡é«˜  
âœ… **æ–‡æ¡£è§„èŒƒå®Œå–„**: å®Œæ•´çš„å¼€å‘æ–‡æ¡£å’ŒAPIæ–‡æ¡£  
âœ… **å¯æ‰©å±•æ€§å¼º**: æ¸…æ™°çš„åˆ†å±‚æ¶æ„ï¼Œæ˜“äºæ‰©å±•

### ä¸»è¦æ”¹è¿›ç‚¹
ğŸ¯ **ç”¨æˆ·ä½“éªŒ**: ç§»åŠ¨ç«¯é€‚é…ã€å®æ—¶é€šçŸ¥  
ğŸ¯ **åŠŸèƒ½æ·±åº¦**: æ–‡æ¡£é¢„è§ˆã€å…¨æ–‡æ£€ç´¢ã€é«˜çº§æŠ¥è¡¨  
ğŸ¯ **æ™ºèƒ½åŒ–**: OCRè¯†åˆ«ã€æ™ºèƒ½åˆ†ç±»  
ğŸ¯ **é›†æˆèƒ½åŠ›**: SSOã€ä¼ä¸šå¾®ä¿¡ã€é’‰é’‰

### å®æ–½å»ºè®®
1. **åˆ†é˜¶æ®µæ¨è¿›**: æŒ‰ä¼˜å…ˆçº§åˆ†ä¸‰ä¸ªé˜¶æ®µï¼Œæ¯ä¸ªé˜¶æ®µ2-4ä¸ªæœˆ
2. **å¿«é€Ÿè¿­ä»£**: é‡‡ç”¨æ•æ·å¼€å‘ï¼Œ2å‘¨ä¸€ä¸ªè¿­ä»£
3. **ç”¨æˆ·å‚ä¸**: å»ºç«‹ç”¨æˆ·åé¦ˆæœºåˆ¶ï¼ŒæŒç»­ä¼˜åŒ–
4. **è´¨é‡ä¿è¯**: å®Œå–„æµ‹è¯•ä½“ç³»ï¼Œç¡®ä¿è´¨é‡
5. **å›¢é˜Ÿå»ºè®¾**: åŠ å¼ºæŠ€æœ¯åˆ†äº«ï¼Œæå‡å›¢é˜Ÿèƒ½åŠ›

### é¢„æœŸæˆæœ
âœ¨ 6ä¸ªæœˆåï¼Œç³»ç»ŸåŠŸèƒ½å®Œå–„åº¦è¾¾åˆ° **95%**  
âœ¨ ç”¨æˆ·æ»¡æ„åº¦æå‡åˆ° **4.5/5** ä»¥ä¸Š  
âœ¨ å¸‚åœºä»½é¢å¢é•¿åˆ° **15%**  
âœ¨ æˆä¸ºè¡Œä¸šé¢†å…ˆçš„æ¡£æ¡ˆç®¡ç†è§£å†³æ–¹æ¡ˆ

---

**æ–‡æ¡£ç»´æŠ¤è€…**: AIå¼€å‘åŠ©æ‰‹  
**æœ€åæ›´æ–°**: 2025å¹´10æœˆ10æ—¥  
**ç‰ˆæœ¬**: v1.0  
**çŠ¶æ€**: å¾…å®¡æ‰¹

---

## ğŸ“ é™„å½•A: ä»£ç è´¨é‡åˆ†æ

### å½“å‰ä»£ç è´¨é‡çŠ¶å†µ

#### 1. ä»£ç é‡ç»Ÿè®¡
- **åç«¯ä»£ç **:
  - Javaæºæ–‡ä»¶: 324ä¸ª
  - ä»£ç è¡Œæ•°: çº¦8-10ä¸‡è¡Œ (ä¼°ç®—)
  - Controllerå±‚: 21ä¸ª
  - Serviceå±‚: 35ä¸ªå®ç°ç±»
  - å·¥å…·ç±»: 20+ä¸ª

- **å‰ç«¯ä»£ç **:
  - Vue/TSæ–‡ä»¶: 147ä¸ª
  - é¡µé¢ç»„ä»¶: 30+ä¸ª
  - ä¸šåŠ¡ç»„ä»¶: 50+ä¸ª
  - å·¥å…·å‡½æ•°: 15+ä¸ª

#### 2. å¾…ä¼˜åŒ–é¡¹ç»Ÿè®¡
- **TODOæ ‡è®°**: 26å¤„
  - PermissionServiceImpl: 5å¤„
  - NotificationServiceImpl: 3å¤„
  - DepartmentServiceImpl: 8å¤„
  - BorrowController: 4å¤„
  - ExportController: 2å¤„
  - ExportTaskServiceImpl: 2å¤„
  - LoginLogServiceImpl: 1å¤„
  - AuditLogUtil: 1å¤„

- **åºŸå¼ƒä»£ç **: 0å¤„ âœ…
- **ä»£ç é‡å¤ç‡**: ä¼°è®¡10-15% (éœ€SonarQubeæ‰«æ)

#### 3. ä¼˜åŒ–å»ºè®®æ¸…å•

##### é«˜ä¼˜å…ˆçº§ä¼˜åŒ–é¡¹
1. **PermissionServiceImpl** (5ä¸ªTODO)
   - å®Œå–„æƒé™éªŒè¯é€»è¾‘
   - ä¼˜åŒ–æƒé™ç¼“å­˜æœºåˆ¶
   - è¡¥å……æƒé™ç»§æ‰¿åŠŸèƒ½
   
2. **DepartmentServiceImpl** (8ä¸ªTODO)
   - å®Œå–„éƒ¨é—¨æ ‘ç»“æ„æ„å»º
   - ä¼˜åŒ–éƒ¨é—¨æˆå‘˜æŸ¥è¯¢
   - è¡¥å……éƒ¨é—¨ç»Ÿè®¡åŠŸèƒ½

3. **BorrowController** (4ä¸ªTODO)
   - å®Œå–„å€Ÿé˜…å®¡æ‰¹æµç¨‹
   - ä¼˜åŒ–å€Ÿé˜…è®°å½•æŸ¥è¯¢
   - è¡¥å……é€¾æœŸæé†’åŠŸèƒ½

##### ä¸­ä¼˜å…ˆçº§ä¼˜åŒ–é¡¹
4. **NotificationServiceImpl** (3ä¸ªTODO)
   - å®Œå–„æ¶ˆæ¯æ¨¡æ¿ç³»ç»Ÿ
   - ä¼˜åŒ–æ¶ˆæ¯æ¨é€ç­–ç•¥
   
5. **ExportController & ExportTaskServiceImpl** (4ä¸ªTODO)
   - å®Œå–„å¤§æ–‡ä»¶å¯¼å‡º
   - ä¼˜åŒ–å¯¼å‡ºè¿›åº¦è¿½è¸ª

##### ä½ä¼˜å…ˆçº§ä¼˜åŒ–é¡¹
6. **LoginLogServiceImpl & AuditLogUtil** (2ä¸ªTODO)
   - è¡¥å……æ—¥å¿—æ¸…ç†ç­–ç•¥
   - ä¼˜åŒ–æ—¥å¿—æŸ¥è¯¢æ€§èƒ½

### ä»£ç é‡æ„è®¡åˆ’

#### ç¬¬ä¸€é˜¶æ®µ: æ¸…ç†TODOæ ‡è®° (2å‘¨)
```java
// ç¤ºä¾‹: PermissionServiceImplå¾…å®Œæˆé¡¹
@Service
public class PermissionServiceImpl implements PermissionService {
    
    // TODO: å®ç°æƒé™ç»§æ‰¿é€»è¾‘
    @Override
    public List<Permission> getInheritedPermissions(Long roleId) {
        // 1. è·å–è§’è‰²è‡ªèº«æƒé™
        List<Permission> ownPermissions = getDirectPermissions(roleId);
        
        // 2. è·å–çˆ¶è§’è‰²æƒé™
        List<Permission> parentPermissions = getParentRolePermissions(roleId);
        
        // 3. åˆå¹¶å»é‡
        Set<Permission> allPermissions = new HashSet<>();
        allPermissions.addAll(ownPermissions);
        allPermissions.addAll(parentPermissions);
        
        return new ArrayList<>(allPermissions);
    }
    
    // TODO: å®ç°æƒé™ç¼“å­˜é¢„çƒ­
    @PostConstruct
    public void initPermissionCache() {
        // åŠ è½½æ‰€æœ‰è§’è‰²æƒé™åˆ°ç¼“å­˜
        List<Role> allRoles = roleService.list();
        allRoles.forEach(role -> {
            List<Permission> permissions = getDirectPermissions(role.getId());
            cacheService.set("role:permissions:" + role.getId(), permissions);
        });
    }
}
```

#### ç¬¬äºŒé˜¶æ®µ: æ¶ˆé™¤ä»£ç é‡å¤ (2å‘¨)
```java
// é‡æ„å‰: å¤šå¤„é‡å¤çš„ç”¨æˆ·éªŒè¯é€»è¾‘
public void methodA() {
    User user = getCurrentUser();
    if (user == null || !user.getEnabled()) {
        throw new UnauthorizedException("ç”¨æˆ·æœªç™»å½•æˆ–å·²ç¦ç”¨");
    }
    // ä¸šåŠ¡é€»è¾‘...
}

public void methodB() {
    User user = getCurrentUser();
    if (user == null || !user.getEnabled()) {
        throw new UnauthorizedException("ç”¨æˆ·æœªç™»å½•æˆ–å·²ç¦ç”¨");
    }
    // ä¸šåŠ¡é€»è¾‘...
}

// é‡æ„å: æå–å…¬å…±æ–¹æ³•
@Service
public class UserValidationService {
    
    public User validateAndGetCurrentUser() {
        User user = SecurityContextHolder.getCurrentUser();
        if (user == null) {
            throw new UnauthorizedException("ç”¨æˆ·æœªç™»å½•");
        }
        if (!user.getEnabled()) {
            throw new UnauthorizedException("ç”¨æˆ·å·²ç¦ç”¨");
        }
        return user;
    }
}

// ä½¿ç”¨AOPè¿›ä¸€æ­¥ç®€åŒ–
@Aspect
@Component
public class UserValidationAspect {
    
    @Before("@annotation(requireAuth)")
    public void validateUser(RequireAuth requireAuth) {
        userValidationService.validateAndGetCurrentUser();
    }
}

// ä½¿ç”¨æ³¨è§£
@RequireAuth
public void methodA() {
    // ä¸šåŠ¡é€»è¾‘ï¼Œæ— éœ€é‡å¤éªŒè¯ä»£ç 
}
```

#### ç¬¬ä¸‰é˜¶æ®µ: æ€§èƒ½ä¼˜åŒ– (3å‘¨)
```java
// ä¼˜åŒ–å‰: N+1æŸ¥è¯¢é—®é¢˜
public List<ArchiveVO> getArchiveList() {
    List<Archive> archives = archiveMapper.selectAll();
    return archives.stream()
        .map(archive -> {
            ArchiveVO vo = new ArchiveVO();
            // Næ¬¡æŸ¥è¯¢
            Category category = categoryMapper.selectById(archive.getCategoryId());
            User creator = userMapper.selectById(archive.getCreatorId());
            vo.setCategoryName(category.getName());
            vo.setCreatorName(creator.getUsername());
            return vo;
        })
        .collect(Collectors.toList());
}

// ä¼˜åŒ–å: ä½¿ç”¨JOINä¸€æ¬¡æ€§æŸ¥è¯¢
@Select("SELECT a.*, c.name as category_name, u.username as creator_name " +
        "FROM archive a " +
        "LEFT JOIN category c ON a.category_id = c.id " +
        "LEFT JOIN user u ON a.creator_id = u.user_id")
List<ArchiveVO> selectArchivesWithDetails();
```

---

## ğŸ“ é™„å½•B: æµ‹è¯•è®¡åˆ’

### å•å…ƒæµ‹è¯•è®¡åˆ’

#### 1. åç«¯å•å…ƒæµ‹è¯•
**ç›®æ ‡è¦†ç›–ç‡**: 80%ä»¥ä¸Š

**æµ‹è¯•æ¡†æ¶**: JUnit 5 + Mockito + Spring Boot Test

```java
// Serviceå±‚æµ‹è¯•ç¤ºä¾‹
@SpringBootTest
@AutoConfigureMockMvc
class ArchiveServiceTest {
    
    @Autowired
    private ArchiveService archiveService;
    
    @MockBean
    private ArchiveMapper archiveMapper;
    
    @Test
    @DisplayName("åˆ›å»ºæ¡£æ¡ˆ - æˆåŠŸ")
    void testCreateArchive_Success() {
        // Given
        Archive archive = new Archive();
        archive.setTitle("æµ‹è¯•æ¡£æ¡ˆ");
        archive.setCategoryId(1L);
        
        when(archiveMapper.insert(any())).thenReturn(1);
        
        // When
        Long archiveId = archiveService.create(archive);
        
        // Then
        assertNotNull(archiveId);
        verify(archiveMapper, times(1)).insert(any());
    }
    
    @Test
    @DisplayName("åˆ›å»ºæ¡£æ¡ˆ - æ ‡é¢˜ä¸ºç©ºåº”æŠ›å‡ºå¼‚å¸¸")
    void testCreateArchive_EmptyTitle_ShouldThrowException() {
        // Given
        Archive archive = new Archive();
        archive.setTitle("");
        
        // When & Then
        assertThrows(ValidationException.class, 
            () -> archiveService.create(archive));
    }
    
    @Test
    @DisplayName("åˆ†é¡µæŸ¥è¯¢æ¡£æ¡ˆ")
    void testGetArchiveList_WithPagination() {
        // Given
        Page<Archive> page = new Page<>(1, 10);
        List<Archive> mockData = createMockArchives(10);
        when(archiveMapper.selectPage(any())).thenReturn(mockData);
        
        // When
        PageResult<Archive> result = archiveService.list(page);
        
        // Then
        assertEquals(10, result.getList().size());
        verify(archiveMapper, times(1)).selectPage(any());
    }
}
```

#### 2. å‰ç«¯å•å…ƒæµ‹è¯•
**ç›®æ ‡è¦†ç›–ç‡**: 70%ä»¥ä¸Š

**æµ‹è¯•æ¡†æ¶**: Vitest + Vue Test Utils

```typescript
// ç»„ä»¶æµ‹è¯•ç¤ºä¾‹
import { describe, it, expect, vi } from 'vitest';
import { mount } from '@vue/test-utils';
import ArchiveForm from '@/components/ArchiveForm.vue';
import { ElForm, ElInput } from 'element-plus';

describe('ArchiveForm.vue', () => {
  it('åº”è¯¥æ­£ç¡®æ¸²æŸ“è¡¨å•', () => {
    const wrapper = mount(ArchiveForm, {
      global: {
        components: { ElForm, ElInput }
      }
    });
    
    expect(wrapper.find('form').exists()).toBe(true);
    expect(wrapper.find('input[name="title"]').exists()).toBe(true);
  });
  
  it('æäº¤ç©ºè¡¨å•åº”æ˜¾ç¤ºéªŒè¯é”™è¯¯', async () => {
    const wrapper = mount(ArchiveForm);
    
    await wrapper.find('form').trigger('submit');
    
    expect(wrapper.find('.error-message').text()).toContain('æ ‡é¢˜ä¸èƒ½ä¸ºç©º');
  });
  
  it('æäº¤æœ‰æ•ˆè¡¨å•åº”è°ƒç”¨API', async () => {
    const mockSubmit = vi.fn();
    const wrapper = mount(ArchiveForm, {
      props: {
        onSubmit: mockSubmit
      }
    });
    
    await wrapper.find('input[name="title"]').setValue('æµ‹è¯•æ¡£æ¡ˆ');
    await wrapper.find('form').trigger('submit');
    
    expect(mockSubmit).toHaveBeenCalledWith({
      title: 'æµ‹è¯•æ¡£æ¡ˆ'
    });
  });
});
```

### é›†æˆæµ‹è¯•è®¡åˆ’

#### 1. APIé›†æˆæµ‹è¯•
```java
@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT)
@AutoConfigureMockMvc
class ArchiveControllerIntegrationTest {
    
    @Autowired
    private MockMvc mockMvc;
    
    @Autowired
    private ObjectMapper objectMapper;
    
    @Test
    @DisplayName("å®Œæ•´çš„æ¡£æ¡ˆåˆ›å»ºæµç¨‹æµ‹è¯•")
    void testArchiveCreationWorkflow() throws Exception {
        // 1. ç™»å½•è·å–token
        String token = loginAndGetToken("admin", "admin123");
        
        // 2. åˆ›å»ºæ¡£æ¡ˆ
        ArchiveRequest request = new ArchiveRequest();
        request.setTitle("é›†æˆæµ‹è¯•æ¡£æ¡ˆ");
        request.setCategoryId(1L);
        
        MvcResult result = mockMvc.perform(post("/api/archives")
                .header("Authorization", "Bearer " + token)
                .contentType(MediaType.APPLICATION_JSON)
                .content(objectMapper.writeValueAsString(request)))
            .andExpect(status().isOk())
            .andExpect(jsonPath("$.data.id").exists())
            .andReturn();
        
        // 3. éªŒè¯æ¡£æ¡ˆå·²åˆ›å»º
        Long archiveId = extractArchiveId(result);
        
        mockMvc.perform(get("/api/archives/" + archiveId)
                .header("Authorization", "Bearer " + token))
            .andExpect(status().isOk())
            .andExpect(jsonPath("$.data.title").value("é›†æˆæµ‹è¯•æ¡£æ¡ˆ"));
    }
}
```

#### 2. E2Eæµ‹è¯•è®¡åˆ’ (Playwright)
```typescript
// tests/e2e/archive-workflow.spec.ts
import { test, expect } from '@playwright/test';

test.describe('æ¡£æ¡ˆç®¡ç†å®Œæ•´æµç¨‹', () => {
  test.beforeEach(async ({ page }) => {
    // ç™»å½•
    await page.goto('http://localhost:3000/login');
    await page.fill('input[name="username"]', 'admin');
    await page.fill('input[name="password"]', 'admin123');
    await page.click('button[type="submit"]');
    await page.waitForURL('**/dashboard');
  });
  
  test('åº”è¯¥èƒ½å¤Ÿåˆ›å»ºã€æŸ¥çœ‹ã€ç¼–è¾‘å’Œåˆ é™¤æ¡£æ¡ˆ', async ({ page }) => {
    // 1. åˆ›å»ºæ¡£æ¡ˆ
    await page.goto('http://localhost:3000/archive/add');
    await page.fill('input[name="title"]', 'E2Eæµ‹è¯•æ¡£æ¡ˆ');
    await page.selectOption('select[name="category"]', '1');
    await page.click('button:has-text("æäº¤")');
    
    // ç­‰å¾…åˆ›å»ºæˆåŠŸæ¶ˆæ¯
    await expect(page.locator('.el-message--success')).toBeVisible();
    
    // 2. æŸ¥çœ‹æ¡£æ¡ˆåˆ—è¡¨
    await page.goto('http://localhost:3000/archive/list');
    await expect(page.locator('text=E2Eæµ‹è¯•æ¡£æ¡ˆ')).toBeVisible();
    
    // 3. ç¼–è¾‘æ¡£æ¡ˆ
    await page.click('text=E2Eæµ‹è¯•æ¡£æ¡ˆ >> xpath=../.. >> button:has-text("ç¼–è¾‘")');
    await page.fill('input[name="title"]', 'E2Eæµ‹è¯•æ¡£æ¡ˆ(å·²ä¿®æ”¹)');
    await page.click('button:has-text("ä¿å­˜")');
    
    await expect(page.locator('.el-message--success')).toBeVisible();
    
    // 4. åˆ é™¤æ¡£æ¡ˆ
    await page.goto('http://localhost:3000/archive/list');
    await page.click('text=E2Eæµ‹è¯•æ¡£æ¡ˆ(å·²ä¿®æ”¹) >> xpath=../.. >> button:has-text("åˆ é™¤")');
    await page.click('button:has-text("ç¡®è®¤")');
    
    await expect(page.locator('text=E2Eæµ‹è¯•æ¡£æ¡ˆ(å·²ä¿®æ”¹)')).not.toBeVisible();
  });
});
```

### æ€§èƒ½æµ‹è¯•è®¡åˆ’

#### 1. JMeterå‹åŠ›æµ‹è¯•è„šæœ¬
```xml
<!-- jmeter-test-plan.jmx -->
<jmeterTestPlan version="1.2">
  <ThreadGroup>
    <stringProp name="ThreadGroup.num_threads">100</stringProp>
    <stringProp name="ThreadGroup.ramp_time">10</stringProp>
    <stringProp name="ThreadGroup.duration">300</stringProp>
    
    <!-- ç™»å½•è¯·æ±‚ -->
    <HTTPSamplerProxy>
      <stringProp name="HTTPSampler.path">/api/auth/login</stringProp>
      <stringProp name="HTTPSampler.method">POST</stringProp>
      <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
    </HTTPSamplerProxy>
    
    <!-- æŸ¥è¯¢æ¡£æ¡ˆåˆ—è¡¨ -->
    <HTTPSamplerProxy>
      <stringProp name="HTTPSampler.path">/api/archives?page=1&size=20</stringProp>
      <stringProp name="HTTPSampler.method">GET</stringProp>
    </HTTPSamplerProxy>
    
    <!-- æŸ¥çœ‹æ¡£æ¡ˆè¯¦æƒ… -->
    <HTTPSamplerProxy>
      <stringProp name="HTTPSampler.path">/api/archives/${archiveId}</stringProp>
      <stringProp name="HTTPSampler.method">GET</stringProp>
    </HTTPSamplerProxy>
  </ThreadGroup>
  
  <!-- æ–­è¨€ -->
  <ResponseAssertion>
    <stringProp name="Assertion.test_field">Assertion.response_time</stringProp>
    <stringProp name="Assertion.test_type">16</stringProp>
    <stringProp name="Assertion.custom_message">å“åº”æ—¶é—´åº”å°äº200ms</stringProp>
    <longProp name="Assertion.expected_value">200</longProp>
  </ResponseAssertion>
</jmeterTestPlan>
```

#### 2. æ€§èƒ½æµ‹è¯•æŒ‡æ ‡
| æµ‹è¯•åœºæ™¯ | å¹¶å‘ç”¨æˆ·æ•° | å¹³å‡å“åº”æ—¶é—´ | 95%å“åº”æ—¶é—´ | TPS | é”™è¯¯ç‡ |
|---------|-----------|-------------|------------|-----|-------|
| æ¡£æ¡ˆåˆ—è¡¨æŸ¥è¯¢ | 100 | <150ms | <300ms | >500 | <1% |
| æ¡£æ¡ˆè¯¦æƒ…æŸ¥è¯¢ | 100 | <100ms | <200ms | >800 | <1% |
| æ¡£æ¡ˆåˆ›å»º | 50 | <500ms | <1000ms | >100 | <1% |
| æ–‡ä»¶ä¸Šä¼  | 20 | <2000ms | <5000ms | >10 | <2% |
| å…¨æ–‡æœç´¢ | 100 | <200ms | <400ms | >400 | <1% |

---

## ğŸ“ é™„å½•C: éƒ¨ç½²æ–‡æ¡£

### Dockeréƒ¨ç½²æŒ‡å—

#### 1. Dockerfileä¼˜åŒ–
```dockerfile
# å¤šé˜¶æ®µæ„å»º - åç«¯
FROM maven:3.8-openjdk-17 AS backend-builder
WORKDIR /app
COPY pom.xml .
RUN mvn dependency:go-offline
COPY src ./src
RUN mvn clean package -DskipTests

# å¤šé˜¶æ®µæ„å»º - å‰ç«¯
FROM node:18-alpine AS frontend-builder
WORKDIR /app
COPY frontend/package*.json ./
RUN npm ci --only=production
COPY frontend/ .
RUN npm run build

# æœ€ç»ˆé•œåƒ - åç«¯
FROM openjdk:17-jre-slim
WORKDIR /app

# æ·»åŠ érootç”¨æˆ·
RUN groupadd -r appuser && useradd -r -g appuser appuser

# å¤åˆ¶jaråŒ…
COPY --from=backend-builder /app/target/*.jar app.jar

# å¤åˆ¶å‰ç«¯æ„å»ºäº§ç‰©
COPY --from=frontend-builder /app/dist /app/static

# å®‰è£…å¥åº·æ£€æŸ¥å·¥å…·
RUN apt-get update && apt-get install -y curl && rm -rf /var/lib/apt/lists/*

# è®¾ç½®æƒé™
RUN chown -R appuser:appuser /app
USER appuser

# å¥åº·æ£€æŸ¥
HEALTHCHECK --interval=30s --timeout=3s --start-period=60s --retries=3 \
  CMD curl -f http://localhost:8080/actuator/health || exit 1

# æš´éœ²ç«¯å£
EXPOSE 8080

# JVMå‚æ•°ä¼˜åŒ–
ENV JAVA_OPTS="-Xms512m -Xmx2g -XX:+UseG1GC -XX:MaxGCPauseMillis=200 \
               -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=/app/logs"

# å¯åŠ¨å‘½ä»¤
ENTRYPOINT ["sh", "-c", "java $JAVA_OPTS -jar app.jar"]
```

#### 2. Docker Composeå®Œæ•´é…ç½®
```yaml
version: '3.8'

services:
  # MySQLæ•°æ®åº“
  mysql:
    image: mysql:8.0
    container_name: archive-mysql
    restart: unless-stopped
    environment:
      MYSQL_ROOT_PASSWORD: ${MYSQL_ROOT_PASSWORD}
      MYSQL_DATABASE: archive_management
      MYSQL_USER: archive_user
      MYSQL_PASSWORD: ${MYSQL_PASSWORD}
      TZ: Asia/Shanghai
    volumes:
      - mysql-data:/var/lib/mysql
      - ./database:/docker-entrypoint-initdb.d:ro
      - ./mysql-conf:/etc/mysql/conf.d:ro
    ports:
      - "3306:3306"
    command: 
      - --character-set-server=utf8mb4
      - --collation-server=utf8mb4_unicode_ci
      - --max_connections=500
      - --innodb_buffer_pool_size=1G
    healthcheck:
      test: ["CMD", "mysqladmin", "ping", "-h", "localhost"]
      interval: 10s
      timeout: 5s
      retries: 5
    networks:
      - archive-network

  # Redisç¼“å­˜
  redis:
    image: redis:7-alpine
    container_name: archive-redis
    restart: unless-stopped
    command: redis-server --requirepass ${REDIS_PASSWORD} --maxmemory 512mb --maxmemory-policy allkeys-lru
    volumes:
      - redis-data:/data
    ports:
      - "6379:6379"
    healthcheck:
      test: ["CMD", "redis-cli", "ping"]
      interval: 10s
      timeout: 5s
      retries: 5
    networks:
      - archive-network

  # Elasticsearch
  elasticsearch:
    image: docker.elastic.co/elasticsearch/elasticsearch:8.10.0
    container_name: archive-elasticsearch
    restart: unless-stopped
    environment:
      - discovery.type=single-node
      - "ES_JAVA_OPTS=-Xms512m -Xmx512m"
      - xpack.security.enabled=false
    volumes:
      - elasticsearch-data:/usr/share/elasticsearch/data
    ports:
      - "9200:9200"
      - "9300:9300"
    healthcheck:
      test: ["CMD-SHELL", "curl -f http://localhost:9200/_cluster/health || exit 1"]
      interval: 30s
      timeout: 10s
      retries: 5
    networks:
      - archive-network

  # åç«¯åº”ç”¨
  backend:
    build:
      context: .
      dockerfile: Dockerfile.backend
    container_name: archive-backend
    restart: unless-stopped
    depends_on:
      mysql:
        condition: service_healthy
      redis:
        condition: service_healthy
    environment:
      SPRING_PROFILES_ACTIVE: prod
      SPRING_DATASOURCE_URL: jdbc:mysql://mysql:3306/archive_management?useSSL=false&serverTimezone=Asia/Shanghai
      SPRING_DATASOURCE_USERNAME: archive_user
      SPRING_DATASOURCE_PASSWORD: ${MYSQL_PASSWORD}
      SPRING_REDIS_HOST: redis
      SPRING_REDIS_PASSWORD: ${REDIS_PASSWORD}
      ELASTICSEARCH_HOST: elasticsearch
      JWT_SECRET: ${JWT_SECRET}
    volumes:
      - ./uploads:/app/uploads
      - ./logs:/app/logs
    ports:
      - "8080:8080"
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8080/actuator/health"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 60s
    networks:
      - archive-network

  # Nginxåå‘ä»£ç†
  nginx:
    image: nginx:alpine
    container_name: archive-nginx
    restart: unless-stopped
    depends_on:
      - backend
    volumes:
      - ./nginx.conf:/etc/nginx/nginx.conf:ro
      - ./frontend/dist:/usr/share/nginx/html:ro
      - ./ssl:/etc/nginx/ssl:ro
      - nginx-logs:/var/log/nginx
    ports:
      - "80:80"
      - "443:443"
    healthcheck:
      test: ["CMD", "wget", "--quiet", "--tries=1", "--spider", "http://localhost/health"]
      interval: 30s
      timeout: 10s
      retries: 3
    networks:
      - archive-network

  # Prometheusç›‘æ§
  prometheus:
    image: prom/prometheus:latest
    container_name: archive-prometheus
    restart: unless-stopped
    volumes:
      - ./monitoring/prometheus.yml:/etc/prometheus/prometheus.yml:ro
      - prometheus-data:/prometheus
    ports:
      - "9090:9090"
    command:
      - '--config.file=/etc/prometheus/prometheus.yml'
      - '--storage.tsdb.path=/prometheus'
      - '--storage.tsdb.retention.time=30d'
    networks:
      - archive-network

  # Grafanaå¯è§†åŒ–
  grafana:
    image: grafana/grafana:latest
    container_name: archive-grafana
    restart: unless-stopped
    depends_on:
      - prometheus
    environment:
      GF_SECURITY_ADMIN_PASSWORD: ${GRAFANA_PASSWORD}
      GF_INSTALL_PLUGINS: grafana-clock-panel
    volumes:
      - grafana-data:/var/lib/grafana
      - ./monitoring/grafana-datasources.yml:/etc/grafana/provisioning/datasources/datasources.yml:ro
      - ./monitoring/grafana-dashboard.json:/etc/grafana/provisioning/dashboards/dashboard.json:ro
    ports:
      - "3001:3000"
    networks:
      - archive-network

volumes:
  mysql-data:
  redis-data:
  elasticsearch-data:
  prometheus-data:
  grafana-data:
  nginx-logs:

networks:
  archive-network:
    driver: bridge
```

#### 3. ç¯å¢ƒå˜é‡é…ç½® (.env)
```env
# æ•°æ®åº“é…ç½®
MYSQL_ROOT_PASSWORD=your_secure_root_password
MYSQL_PASSWORD=your_secure_user_password

# Redisé…ç½®
REDIS_PASSWORD=your_secure_redis_password

# JWTé…ç½®
JWT_SECRET=your_very_long_and_secure_jwt_secret_key_here

# Grafanaé…ç½®
GRAFANA_PASSWORD=your_secure_grafana_password

# åº”ç”¨é…ç½®
APP_ENV=production
APP_DEBUG=false
APP_LOG_LEVEL=info
```

### Kuberneteséƒ¨ç½²é…ç½®

#### 1. Deploymenté…ç½®
```yaml
# k8s/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: archive-backend
  namespace: archive-system
  labels:
    app: archive-backend
spec:
  replicas: 3
  selector:
    matchLabels:
      app: archive-backend
  template:
    metadata:
      labels:
        app: archive-backend
    spec:
      containers:
      - name: backend
        image: archive-system:latest
        imagePullPolicy: IfNotPresent
        ports:
        - containerPort: 8080
          name: http
          protocol: TCP
        env:
        - name: SPRING_PROFILES_ACTIVE
          value: "prod"
        - name: SPRING_DATASOURCE_URL
          valueFrom:
            configMapKeyRef:
              name: archive-config
              key: database-url
        - name: SPRING_DATASOURCE_PASSWORD
          valueFrom:
            secretKeyRef:
              name: archive-secrets
              key: database-password
        resources:
          requests:
            memory: "512Mi"
            cpu: "500m"
          limits:
            memory: "2Gi"
            cpu: "2000m"
        livenessProbe:
          httpGet:
            path: /actuator/health/liveness
            port: 8080
          initialDelaySeconds: 60
          periodSeconds: 30
          timeoutSeconds: 5
          failureThreshold: 3
        readinessProbe:
          httpGet:
            path: /actuator/health/readiness
            port: 8080
          initialDelaySeconds: 30
          periodSeconds: 10
          timeoutSeconds: 5
          failureThreshold: 3
        volumeMounts:
        - name: uploads
          mountPath: /app/uploads
        - name: logs
          mountPath: /app/logs
      volumes:
      - name: uploads
        persistentVolumeClaim:
          claimName: archive-uploads-pvc
      - name: logs
        persistentVolumeClaim:
          claimName: archive-logs-pvc
---
apiVersion: v1
kind: Service
metadata:
  name: archive-backend-service
  namespace: archive-system
spec:
  type: ClusterIP
  selector:
    app: archive-backend
  ports:
  - port: 8080
    targetPort: 8080
    protocol: TCP
    name: http
---
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: archive-ingress
  namespace: archive-system
  annotations:
    kubernetes.io/ingress.class: "nginx"
    cert-manager.io/cluster-issuer: "letsencrypt-prod"
    nginx.ingress.kubernetes.io/ssl-redirect: "true"
spec:
  tls:
  - hosts:
    - archive.example.com
    secretName: archive-tls
  rules:
  - host: archive.example.com
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: archive-backend-service
            port:
              number: 8080
```

---

## ğŸ“ é™„å½•D: ç›‘æ§ä¸å‘Šè­¦é…ç½®

### Prometheusé…ç½®
```yaml
# monitoring/prometheus.yml
global:
  scrape_interval: 15s
  evaluation_interval: 15s

alerting:
  alertmanagers:
    - static_configs:
        - targets:
            - 'alertmanager:9093'

rule_files:
  - "/etc/prometheus/alert_rules.yml"

scrape_configs:
  # Spring Bootåº”ç”¨ç›‘æ§
  - job_name: 'archive-backend'
    metrics_path: '/actuator/prometheus'
    static_configs:
      - targets: ['backend:8080']
        labels:
          service: 'archive-backend'
  
  # MySQLç›‘æ§
  - job_name: 'mysql'
    static_configs:
      - targets: ['mysql-exporter:9104']
        labels:
          service: 'mysql'
  
  # Redisç›‘æ§
  - job_name: 'redis'
    static_configs:
      - targets: ['redis-exporter:9121']
        labels:
          service: 'redis'
  
  # Nginxç›‘æ§
  - job_name: 'nginx'
    static_configs:
      - targets: ['nginx-exporter:9113']
        labels:
          service: 'nginx'
```

### å‘Šè­¦è§„åˆ™é…ç½®
```yaml
# monitoring/alert_rules.yml
groups:
  - name: application_alerts
    interval: 30s
    rules:
      # åº”ç”¨å“åº”æ—¶é—´å‘Šè­¦
      - alert: HighResponseTime
        expr: http_server_requests_seconds_sum{job="archive-backend"} / http_server_requests_seconds_count{job="archive-backend"} > 1
        for: 5m
        labels:
          severity: warning
        annotations:
          summary: "é«˜å“åº”æ—¶é—´å‘Šè­¦"
          description: "{{ $labels.instance }} å¹³å‡å“åº”æ—¶é—´è¶…è¿‡1ç§’"
      
      # é”™è¯¯ç‡å‘Šè­¦
      - alert: HighErrorRate
        expr: rate(http_server_requests_seconds_count{status=~"5.."}[5m]) > 0.05
        for: 5m
        labels:
          severity: critical
        annotations:
          summary: "é«˜é”™è¯¯ç‡å‘Šè­¦"
          description: "{{ $labels.instance }} é”™è¯¯ç‡è¶…è¿‡5%"
      
      # CPUä½¿ç”¨ç‡å‘Šè­¦
      - alert: HighCPUUsage
        expr: process_cpu_usage{job="archive-backend"} > 0.8
        for: 10m
        labels:
          severity: warning
        annotations:
          summary: "CPUä½¿ç”¨ç‡è¿‡é«˜"
          description: "{{ $labels.instance }} CPUä½¿ç”¨ç‡è¶…è¿‡80%"
      
      # å†…å­˜ä½¿ç”¨å‘Šè­¦
      - alert: HighMemoryUsage
        expr: jvm_memory_used_bytes{area="heap"} / jvm_memory_max_bytes{area="heap"} > 0.85
        for: 5m
        labels:
          severity: warning
        annotations:
          summary: "å†…å­˜ä½¿ç”¨ç‡è¿‡é«˜"
          description: "{{ $labels.instance }} å †å†…å­˜ä½¿ç”¨è¶…è¿‡85%"
      
      # æ•°æ®åº“è¿æ¥æ± å‘Šè­¦
      - alert: DatabaseConnectionPoolExhausted
        expr: hikaricp_connections_active / hikaricp_connections_max > 0.9
        for: 5m
        labels:
          severity: critical
        annotations:
          summary: "æ•°æ®åº“è¿æ¥æ± å‘Šè­¦"
          description: "{{ $labels.instance }} è¿æ¥æ± ä½¿ç”¨ç‡è¶…è¿‡90%"

  - name: infrastructure_alerts
    interval: 30s
    rules:
      # MySQLå¯ç”¨æ€§
      - alert: MySQLDown
        expr: up{job="mysql"} == 0
        for: 1m
        labels:
          severity: critical
        annotations:
          summary: "MySQLæœåŠ¡ä¸å¯ç”¨"
          description: "MySQLå®ä¾‹ {{ $labels.instance }} å·²å®•æœº"
      
      # Rediså¯ç”¨æ€§
      - alert: RedisDown
        expr: up{job="redis"} == 0
        for: 1m
        labels:
          severity: critical
        annotations:
          summary: "RedisæœåŠ¡ä¸å¯ç”¨"
          description: "Rediså®ä¾‹ {{ $labels.instance }} å·²å®•æœº"
      
      # ç£ç›˜ç©ºé—´å‘Šè­¦
      - alert: DiskSpaceWarning
        expr: (node_filesystem_avail_bytes / node_filesystem_size_bytes) < 0.2
        for: 5m
        labels:
          severity: warning
        annotations:
          summary: "ç£ç›˜ç©ºé—´ä¸è¶³"
          description: "{{ $labels.instance }} ç£ç›˜å‰©ä½™ç©ºé—´å°‘äº20%"
```

### Grafana Dashboardé…ç½®
```json
{
  "dashboard": {
    "title": "æ¡£æ¡ˆç®¡ç†ç³»ç»Ÿç›‘æ§é¢æ¿",
    "panels": [
      {
        "title": "APIè¯·æ±‚é‡ (QPS)",
        "targets": [
          {
            "expr": "rate(http_server_requests_seconds_count[1m])",
            "legendFormat": "{{method}} {{uri}}"
          }
        ]
      },
      {
        "title": "APIå“åº”æ—¶é—´ (P95)",
        "targets": [
          {
            "expr": "histogram_quantile(0.95, rate(http_server_requests_seconds_bucket[5m]))",
            "legendFormat": "{{method}} {{uri}}"
          }
        ]
      },
      {
        "title": "é”™è¯¯ç‡",
        "targets": [
          {
            "expr": "rate(http_server_requests_seconds_count{status=~\"5..\"}[5m])",
            "legendFormat": "5xxé”™è¯¯"
          }
        ]
      },
      {
        "title": "JVMå†…å­˜ä½¿ç”¨",
        "targets": [
          {
            "expr": "jvm_memory_used_bytes{area=\"heap\"}",
            "legendFormat": "Heapä½¿ç”¨é‡"
          },
          {
            "expr": "jvm_memory_max_bytes{area=\"heap\"}",
            "legendFormat": "Heapæœ€å¤§å€¼"
          }
        ]
      },
      {
        "title": "æ•°æ®åº“è¿æ¥æ± ",
        "targets": [
          {
            "expr": "hikaricp_connections_active",
            "legendFormat": "æ´»è·ƒè¿æ¥"
          },
          {
            "expr": "hikaricp_connections_idle",
            "legendFormat": "ç©ºé—²è¿æ¥"
          }
        ]
      }
    ]
  }
}
```

---

## ğŸ“ é™„å½•E: å®‰å…¨åŠ å›ºæŒ‡å—

### 1. åº”ç”¨å±‚å®‰å…¨

#### HTTPSé…ç½®
```nginx
# nginx-ssl.conf
server {
    listen 80;
    server_name archive.example.com;
    return 301 https://$server_name$request_uri;
}

server {
    listen 443 ssl http2;
    server_name archive.example.com;
    
    # SSLè¯ä¹¦é…ç½®
    ssl_certificate /etc/nginx/ssl/fullchain.pem;
    ssl_certificate_key /etc/nginx/ssl/privkey.pem;
    
    # SSLä¼˜åŒ–é…ç½®
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers 'ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256';
    ssl_prefer_server_ciphers on;
    ssl_session_cache shared:SSL:10m;
    ssl_session_timeout 10m;
    
    # å®‰å…¨å¤´é…ç½®
    add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;
    add_header X-Frame-Options "SAMEORIGIN" always;
    add_header X-Content-Type-Options "nosniff" always;
    add_header X-XSS-Protection "1; mode=block" always;
    add_header Content-Security-Policy "default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline';" always;
    
    location / {
        proxy_pass http://backend:8080;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}
```

#### é˜²ç«å¢™è§„åˆ™
```bash
# firewall-rules.sh
#!/bin/bash

# å…è®¸SSH
ufw allow 22/tcp

# å…è®¸HTTP/HTTPS
ufw allow 80/tcp
ufw allow 443/tcp

# é™åˆ¶æ•°æ®åº“è®¿é—®ï¼ˆä»…å…è®¸åº”ç”¨æœåŠ¡å™¨ï¼‰
ufw allow from 172.18.0.0/24 to any port 3306
ufw allow from 172.18.0.0/24 to any port 6379

# å¯ç”¨é˜²ç«å¢™
ufw --force enable

# é…ç½®fail2ban
cat > /etc/fail2ban/jail.local <<EOF
[DEFAULT]
bantime = 3600
findtime = 600
maxretry = 5

[sshd]
enabled = true

[nginx-http-auth]
enabled = true
EOF

systemctl restart fail2ban
```

### 2. æ•°æ®åº“å®‰å…¨

#### MySQLå®‰å…¨é…ç½®
```sql
-- mysql-security.sql

-- åˆ é™¤åŒ¿åç”¨æˆ·
DELETE FROM mysql.user WHERE User='';

-- åˆ é™¤testæ•°æ®åº“
DROP DATABASE IF EXISTS test;
DELETE FROM mysql.db WHERE Db='test' OR Db='test\\_%';

-- ç¦æ­¢rootè¿œç¨‹ç™»å½•
DELETE FROM mysql.user WHERE User='root' AND Host NOT IN ('localhost', '127.0.0.1', '::1');

-- åˆ›å»ºåº”ç”¨ä¸“ç”¨ç”¨æˆ·ï¼ˆé™åˆ¶æƒé™ï¼‰
CREATE USER IF NOT EXISTS 'archive_user'@'172.18.0.%' IDENTIFIED BY 'secure_password';
GRANT SELECT, INSERT, UPDATE, DELETE ON archive_management.* TO 'archive_user'@'172.18.0.%';

-- åˆ·æ–°æƒé™
FLUSH PRIVILEGES;

-- å¯ç”¨å®¡è®¡æ—¥å¿—
SET GLOBAL general_log = 'ON';
SET GLOBAL log_output = 'TABLE';
```

#### Rediså®‰å…¨é…ç½®
```conf
# redis-security.conf

# è®¾ç½®å¼ºå¯†ç 
requirepass your_very_secure_redis_password_here

# ç»‘å®šåˆ°å†…ç½‘IP
bind 127.0.0.1 172.18.0.1

# ç¦ç”¨å±é™©å‘½ä»¤
rename-command FLUSHDB ""
rename-command FLUSHALL ""
rename-command CONFIG ""
rename-command SHUTDOWN ""

# å¯ç”¨æŒä¹…åŒ–
save 900 1
save 300 10
save 60 10000

# è®¾ç½®æœ€å¤§å†…å­˜
maxmemory 512mb
maxmemory-policy allkeys-lru
```

### 3. åº”ç”¨å®‰å…¨é…ç½®

#### Spring Securityå¢å¼º
```java
@Configuration
@EnableWebSecurity
public class SecurityConfig {
    
    @Bean
    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {
        http
            // CSRFé˜²æŠ¤
            .csrf()
                .csrfTokenRepository(CookieCsrfTokenRepository.withHttpOnlyFalse())
            .and()
            
            // ç‚¹å‡»åŠ«æŒé˜²æŠ¤
            .headers()
                .frameOptions().deny()
                .xssProtection().and()
                .contentSecurityPolicy("default-src 'self'")
            .and()
            
            // ä¼šè¯ç®¡ç†
            .sessionManagement()
                .sessionCreationPolicy(SessionCreationPolicy.STATELESS)
                .maximumSessions(1)
                .maxSessionsPreventsLogin(true)
            .and()
            .and()
            
            // æˆæƒé…ç½®
            .authorizeHttpRequests()
                .requestMatchers("/api/auth/**").permitAll()
                .requestMatchers("/api/public/**").permitAll()
                .anyRequest().authenticated()
            .and()
            
            // JWTè¿‡æ»¤å™¨
            .addFilterBefore(jwtAuthenticationFilter(), UsernamePasswordAuthenticationFilter.class);
        
        return http.build();
    }
    
    @Bean
    public PasswordEncoder passwordEncoder() {
        // ä½¿ç”¨BCryptå¼ºå¯†ç ç¼–ç 
        return new BCryptPasswordEncoder(12);
    }
}
```

#### è¾“å…¥éªŒè¯
```java
@RestController
@Validated
public class ArchiveController {
    
    @PostMapping("/archives")
    public Result<Archive> create(
        @RequestBody @Valid ArchiveRequest request) {
        
        // ä½¿ç”¨Hibernate ValidatoréªŒè¯
        return Result.success(archiveService.create(request));
    }
}

@Data
public class ArchiveRequest {
    
    @NotBlank(message = "æ ‡é¢˜ä¸èƒ½ä¸ºç©º")
    @Size(min = 1, max = 200, message = "æ ‡é¢˜é•¿åº¦å¿…é¡»åœ¨1-200ä¹‹é—´")
    @Pattern(regexp = "^[\\u4e00-\\u9fa5a-zA-Z0-9\\s]+$", message = "æ ‡é¢˜åªèƒ½åŒ…å«ä¸­æ–‡ã€å­—æ¯ã€æ•°å­—å’Œç©ºæ ¼")
    private String title;
    
    @NotNull(message = "åˆ†ç±»IDä¸èƒ½ä¸ºç©º")
    @Min(value = 1, message = "æ— æ•ˆçš„åˆ†ç±»ID")
    private Long categoryId;
    
    @Size(max = 1000, message = "æè¿°ä¸èƒ½è¶…è¿‡1000å­—")
    private String description;
}
```

---

## ğŸ“ é™„å½•F: æ•…éšœæ’æŸ¥æŒ‡å—

### å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ

#### 1. æ•°æ®åº“è¿æ¥é—®é¢˜

**ç—‡çŠ¶**: åº”ç”¨æ— æ³•è¿æ¥åˆ°MySQL

**æ’æŸ¥æ­¥éª¤**:
```bash
# 1. æ£€æŸ¥MySQLæœåŠ¡çŠ¶æ€
docker exec archive-mysql mysqladmin ping -h localhost -p

# 2. æ£€æŸ¥ç½‘ç»œè¿é€šæ€§
docker exec archive-backend ping mysql

# 3. æ£€æŸ¥æ•°æ®åº“é…ç½®
docker exec archive-backend env | grep SPRING_DATASOURCE

# 4. æŸ¥çœ‹æ•°æ®åº“æ—¥å¿—
docker logs archive-mysql --tail 100

# 5. éªŒè¯ç”¨æˆ·æƒé™
docker exec -it archive-mysql mysql -uroot -p
> SHOW GRANTS FOR 'archive_user'@'%';
```

**è§£å†³æ–¹æ¡ˆ**:
- ç¡®ä¿MySQLå®¹å™¨æ­£å¸¸è¿è¡Œ
- æ£€æŸ¥æ•°æ®åº“å¯†ç æ˜¯å¦æ­£ç¡®
- éªŒè¯ç½‘ç»œè¿æ¥ï¼ˆDockerç½‘ç»œï¼‰
- æ£€æŸ¥é˜²ç«å¢™è§„åˆ™

#### 2. Redisç¼“å­˜é—®é¢˜

**ç—‡çŠ¶**: ç¼“å­˜å¤±æ•ˆæˆ–å“åº”æ…¢

**æ’æŸ¥æ­¥éª¤**:
```bash
# 1. æ£€æŸ¥RedisçŠ¶æ€
docker exec archive-redis redis-cli -a ${REDIS_PASSWORD} ping

# 2. æŸ¥çœ‹å†…å­˜ä½¿ç”¨
docker exec archive-redis redis-cli -a ${REDIS_PASSWORD} info memory

# 3. æ£€æŸ¥ç¼“å­˜å‘½ä¸­ç‡
docker exec archive-redis redis-cli -a ${REDIS_PASSWORD} info stats | grep keyspace

# 4. ç›‘æ§å‘½ä»¤æ‰§è¡Œ
docker exec archive-redis redis-cli -a ${REDIS_PASSWORD} monitor
```

**è§£å†³æ–¹æ¡ˆ**:
- æ£€æŸ¥Rediså†…å­˜é…ç½®
- ä¼˜åŒ–ç¼“å­˜è¿‡æœŸç­–ç•¥
- è°ƒæ•´maxmemory-policy
- å®æ–½ç¼“å­˜é¢„çƒ­

#### 3. åº”ç”¨æ€§èƒ½é—®é¢˜

**ç—‡çŠ¶**: å“åº”æ—¶é—´è¿‡é•¿

**æ’æŸ¥æ­¥éª¤**:
```bash
# 1. æ£€æŸ¥JVMå†…å­˜
docker exec archive-backend jstat -gc 1

# 2. ç”Ÿæˆçº¿ç¨‹dump
docker exec archive-backend jstack 1 > thread_dump.txt

# 3. ç”Ÿæˆå †dump
docker exec archive-backend jmap -dump:live,format=b,file=/app/logs/heap_dump.hprof 1

# 4. æŸ¥çœ‹æ…¢æŸ¥è¯¢æ—¥å¿—
docker exec archive-mysql mysql -uroot -p -e "SELECT * FROM mysql.slow_log ORDER BY start_time DESC LIMIT 10"
```

**è§£å†³æ–¹æ¡ˆ**:
- åˆ†æçº¿ç¨‹dumpæ‰¾å‡ºé˜»å¡ç‚¹
- ä½¿ç”¨MATåˆ†æå †dump
- ä¼˜åŒ–æ…¢SQLæŸ¥è¯¢
- å¢åŠ åº”ç”¨å®ä¾‹

---

**æ–‡æ¡£ç»´æŠ¤è€…**: AIå¼€å‘åŠ©æ‰‹  
**æœ€åæ›´æ–°**: 2025å¹´10æœˆ10æ—¥  
**ç‰ˆæœ¬**: v2.0 (å·²å®Œå–„)  
**çŠ¶æ€**: å·²å®Œå–„ï¼Œå¾…å®¡æ‰¹

