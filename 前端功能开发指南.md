# 前端功能开发指南

## 📋 项目概述

本文档基于对档案管理系统前端项目的全面分析，提供了详细的功能开发指南。当前项目已实现核心业务功能，但在系统管理和高级特性方面还有待完善。

## 🎯 功能完整度评估

- **核心业务功能**：90% 完成度 ✅
- **系统管理功能**：40% 完成度 ⚠️
- **高级功能特性**：30% 完成度 ❌

## 🔴 高优先级待开发功能

### 1. 系统管理页面模块

#### 1.1 角色管理页面 (RoleManagement.vue)

**文件路径**: `src/pages/system/RoleManagement.vue`

**功能需求**:
- 角色列表展示（表格形式）
- 角色创建、编辑、删除
- 权限分配（树形结构选择）
- 角色状态管理
- 批量操作支持

**技术要点**:
```vue
<template>
  <div class="role-management">
    <!-- 搜索栏 -->
    <div class="search-form">
      <el-form inline>
        <el-form-item label="角色名称">
          <el-input v-model="searchForm.roleName" placeholder="请输入角色名称" />
        </el-form-item>
        <el-form-item label="状态">
          <el-select v-model="searchForm.status" placeholder="请选择状态">
            <el-option label="启用" value="active" />
            <el-option label="禁用" value="inactive" />
          </el-select>
        </el-form-item>
        <el-form-item>
          <el-button type="primary" @click="handleSearch">搜索</el-button>
          <el-button @click="handleReset">重置</el-button>
        </el-form-item>
      </el-form>
    </div>

    <!-- 操作栏 -->
    <div class="action-bar">
      <el-button type="primary" @click="handleAdd" v-permission="'role:create'">
        新增角色
      </el-button>
    </div>

    <!-- 角色表格 -->
    <el-table :data="roleList" v-loading="loading">
      <el-table-column prop="roleName" label="角色名称" />
      <el-table-column prop="roleCode" label="角色编码" />
      <el-table-column prop="description" label="描述" />
      <el-table-column prop="status" label="状态">
        <template #default="{ row }">
          <el-tag :type="row.status === 'active' ? 'success' : 'danger'">
            {{ row.status === 'active' ? '启用' : '禁用' }}
          </el-tag>
        </template>
      </el-table-column>
      <el-table-column prop="createdAt" label="创建时间" />
      <el-table-column label="操作" width="200">
        <template #default="{ row }">
          <el-button size="small" @click="handleEdit(row)" v-permission="'role:edit'">
            编辑
          </el-button>
          <el-button size="small" @click="handleAssignPermissions(row)" v-permission="'role:permission'">
            分配权限
          </el-button>
          <el-button size="small" type="danger" @click="handleDelete(row)" v-permission="'role:delete'">
            删除
          </el-button>
        </template>
      </el-table-column>
    </el-table>

    <!-- 权限分配对话框 -->
    <el-dialog v-model="permissionDialogVisible" title="分配权限" width="600px">
      <el-tree
        ref="permissionTreeRef"
        :data="permissionTree"
        :props="{ children: 'children', label: 'name' }"
        show-checkbox
        node-key="id"
        :default-checked-keys="selectedPermissions"
      />
      <template #footer>
        <el-button @click="permissionDialogVisible = false">取消</el-button>
        <el-button type="primary" @click="handleSavePermissions">确定</el-button>
      </template>
    </el-dialog>
  </div>
</template>
```

#### 1.2 权限管理页面 (PermissionManagement.vue)

**文件路径**: `src/pages/system/PermissionManagement.vue`

**功能需求**:
- 权限树形结构展示
- 权限创建、编辑、删除
- 权限层级管理
- 权限类型分类（菜单权限、操作权限、数据权限）

#### 1.3 系统配置页面 (SystemConfig.vue)

**文件路径**: `src/pages/system/SystemConfig.vue`

**功能需求**:
- 系统基础配置
- 业务规则设置
- 文件上传配置
- 邮件配置
- 安全配置

#### 1.4 日志管理页面 (LogManagement.vue)

**文件路径**: `src/pages/system/LogManagement.vue`

**功能需求**:
- 操作日志查询
- 登录日志查询
- 系统日志查询
- 日志导出功能
- 日志统计分析

### 2. 系统管理API模块

#### 2.1 角色管理API (role.ts)

**文件路径**: `src/api/modules/role.ts`

```typescript
import { request } from "@/utils/request";
import type { Role, RoleCreateForm, RoleUpdateForm, RoleQueryParams } from "@/types/role";

// 获取角色列表
export const getRoleList = (params?: RoleQueryParams) => {
  return request.get<ApiResponse<PaginatedResponse<Role>>>("/api/roles", { params });
};

// 获取角色详情
export const getRoleDetail = (id: string) => {
  return request.get<ApiResponse<Role>>(`/api/roles/${id}`);
};

// 创建角色
export const createRole = (data: RoleCreateForm) => {
  return request.post<ApiResponse<Role>>("/api/roles", data);
};

// 更新角色
export const updateRole = (id: string, data: RoleUpdateForm) => {
  return request.put<ApiResponse<Role>>(`/api/roles/${id}`, data);
};

// 删除角色
export const deleteRole = (id: string) => {
  return request.delete<ApiResponse<null>>(`/api/roles/${id}`);
};

// 分配权限给角色
export const assignPermissionsToRole = (roleId: string, permissionIds: string[]) => {
  return request.post<ApiResponse<null>>(`/api/roles/${roleId}/permissions`, {
    permissionIds
  });
};

// 获取角色权限
export const getRolePermissions = (roleId: string) => {
  return request.get<ApiResponse<string[]>>(`/api/roles/${roleId}/permissions`);
};
```

#### 2.2 权限管理API (permission.ts)

**文件路径**: `src/api/modules/permission.ts`

```typescript
import { request } from "@/utils/request";
import type { Permission, PermissionTree } from "@/types/permission";

// 获取权限树
export const getPermissionTree = () => {
  return request.get<ApiResponse<PermissionTree[]>>("/api/permissions/tree");
};

// 获取权限列表
export const getPermissionList = () => {
  return request.get<ApiResponse<Permission[]>>("/api/permissions");
};

// 创建权限
export const createPermission = (data: Partial<Permission>) => {
  return request.post<ApiResponse<Permission>>("/api/permissions", data);
};

// 更新权限
export const updatePermission = (id: string, data: Partial<Permission>) => {
  return request.put<ApiResponse<Permission>>(`/api/permissions/${id}`, data);
};

// 删除权限
export const deletePermission = (id: string) => {
  return request.delete<ApiResponse<null>>(`/api/permissions/${id}`);
};
```

#### 2.3 系统配置API (config.ts)

**文件路径**: `src/api/modules/config.ts`

```typescript
import { request } from "@/utils/request";
import type { SystemConfig } from "@/types/config";

// 获取系统配置
export const getSystemConfig = () => {
  return request.get<ApiResponse<SystemConfig>>("/api/system/config");
};

// 更新系统配置
export const updateSystemConfig = (data: Partial<SystemConfig>) => {
  return request.put<ApiResponse<SystemConfig>>("/api/system/config", data);
};

// 获取配置项
export const getConfigItem = (key: string) => {
  return request.get<ApiResponse<any>>(`/api/system/config/${key}`);
};

// 设置配置项
export const setConfigItem = (key: string, value: any) => {
  return request.put<ApiResponse<null>>(`/api/system/config/${key}`, { value });
};
```

#### 2.4 日志管理API (log.ts)

**文件路径**: `src/api/modules/log.ts`

```typescript
import { request } from "@/utils/request";
import type { OperationLog, LoginLog, SystemLog, LogQueryParams } from "@/types/log";

// 获取操作日志
export const getOperationLogs = (params?: LogQueryParams) => {
  return request.get<ApiResponse<PaginatedResponse<OperationLog>>>("/api/logs/operation", { params });
};

// 获取登录日志
export const getLoginLogs = (params?: LogQueryParams) => {
  return request.get<ApiResponse<PaginatedResponse<LoginLog>>>("/api/logs/login", { params });
};

// 获取系统日志
export const getSystemLogs = (params?: LogQueryParams) => {
  return request.get<ApiResponse<PaginatedResponse<SystemLog>>>("/api/logs/system", { params });
};

// 导出日志
export const exportLogs = (type: string, params?: LogQueryParams) => {
  return request.get(`/api/logs/${type}/export`, {
    params,
    responseType: "blob"
  });
};

// 清理日志
export const clearLogs = (type: string, beforeDate: string) => {
  return request.delete(`/api/logs/${type}/clear`, {
    data: { beforeDate }
  });
};
```

## 🟡 中优先级待开发功能

### 3. 审计日志功能

#### 3.1 日志记录组件

**文件路径**: `src/components/AuditLogger.vue`

**功能需求**:
- 自动记录用户操作
- 敏感操作特殊标记
- 操作结果记录
- 异常操作告警

#### 3.2 日志查看器

**文件路径**: `src/components/LogViewer.vue`

**功能需求**:
- 多维度日志筛选
- 时间范围选择
- 操作类型分类
- 用户操作轨迹

### 4. 通知系统

#### 4.1 通知中心

**文件路径**: `src/components/NotificationCenter.vue`

**功能需求**:
- 实时消息推送
- 消息分类管理
- 已读/未读状态
- 消息历史记录

#### 4.2 通知设置

**文件路径**: `src/pages/user/NotificationSettings.vue`

**功能需求**:
- 通知偏好设置
- 推送方式选择
- 消息类型订阅
- 免打扰时间设置

### 5. 部门管理功能

#### 5.1 部门管理页面

**文件路径**: `src/pages/system/DepartmentManagement.vue`

**功能需求**:
- 部门树形结构
- 部门CRUD操作
- 部门层级调整
- 用户部门分配

## 🟢 低优先级待开发功能

### 6. 高级权限功能

#### 6.1 数据权限配置

**功能需求**:
- 数据范围权限
- 字段级权限控制
- 动态权限规则
- 权限继承机制

### 7. 系统监控功能

#### 7.1 系统监控面板

**文件路径**: `src/pages/system/SystemMonitor.vue`

**功能需求**:
- 系统性能指标
- 在线用户统计
- 资源使用情况
- 系统健康状态

### 8. 数据备份与恢复

#### 8.1 备份管理

**文件路径**: `src/pages/system/BackupManagement.vue`

**功能需求**:
- 备份计划设置
- 手动备份操作
- 备份文件管理
- 恢复操作界面

## 📁 类型定义文件

### Role 类型定义

**文件路径**: `src/types/role.ts`

```typescript
export interface Role {
  id: string;
  roleName: string;
  roleCode: string;
  description?: string;
  status: 'active' | 'inactive';
  permissions: string[];
  createdAt: string;
  updatedAt: string;
  createdBy: string;
}

export interface RoleCreateForm {
  roleName: string;
  roleCode: string;
  description?: string;
  status: 'active' | 'inactive';
}

export interface RoleUpdateForm extends Partial<RoleCreateForm> {}

export interface RoleQueryParams {
  roleName?: string;
  status?: string;
  page?: number;
  size?: number;
}
```

### Permission 类型定义

**文件路径**: `src/types/permission.ts`

```typescript
export interface Permission {
  id: string;
  name: string;
  code: string;
  type: 'menu' | 'button' | 'api' | 'data';
  parentId?: string;
  path?: string;
  component?: string;
  icon?: string;
  sort: number;
  status: 'active' | 'inactive';
  description?: string;
  createdAt: string;
  updatedAt: string;
}

export interface PermissionTree extends Permission {
  children?: PermissionTree[];
}
```

### Log 类型定义

**文件路径**: `src/types/log.ts`

```typescript
export interface OperationLog {
  id: string;
  userId: string;
  username: string;
  operation: string;
  module: string;
  method: string;
  params?: string;
  result?: string;
  ip: string;
  userAgent: string;
  status: 'success' | 'failure';
  errorMsg?: string;
  executionTime: number;
  createdAt: string;
}

export interface LoginLog {
  id: string;
  userId: string;
  username: string;
  ip: string;
  location?: string;
  userAgent: string;
  loginType: 'web' | 'mobile' | 'api';
  status: 'success' | 'failure';
  errorMsg?: string;
  createdAt: string;
}

export interface SystemLog {
  id: string;
  level: 'info' | 'warn' | 'error' | 'debug';
  module: string;
  message: string;
  exception?: string;
  createdAt: string;
}

export interface LogQueryParams {
  userId?: string;
  username?: string;
  module?: string;
  status?: string;
  startTime?: string;
  endTime?: string;
  page?: number;
  size?: number;
}
```

## 🛠️ 开发建议

### 1. 开发顺序建议

1. **第一阶段**：完成系统管理页面和API
   - 角色管理页面和API
   - 权限管理页面和API
   - 系统配置页面和API

2. **第二阶段**：完善日志和通知功能
   - 日志管理页面和API
   - 通知系统实现

3. **第三阶段**：高级功能开发
   - 部门管理功能
   - 高级权限功能
   - 系统监控功能

### 2. 技术要点

- **权限控制**：使用 `v-permission` 指令进行页面级权限控制
- **状态管理**：使用 Pinia 管理系统配置和用户权限状态
- **API 设计**：遵循 RESTful 规范，统一错误处理
- **UI 组件**：基于 Element Plus 构建，保持界面一致性
- **类型安全**：使用 TypeScript 确保类型安全

### 3. 测试建议

- **单元测试**：为每个 API 模块编写单元测试
- **集成测试**：测试页面组件与 API 的集成
- **E2E 测试**：测试完整的用户操作流程

## 📝 总结

本开发指南涵盖了档案管理系统前端项目的所有待开发功能，按照优先级进行了分类，并提供了详细的实现方案。建议按照优先级顺序进行开发，确保系统功能的完整性和稳定性。

在开发过程中，请严格遵循项目的编码规范和设计模式，确保代码质量和可维护性。